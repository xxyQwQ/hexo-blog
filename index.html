<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-128x128.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"xxyqwq.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":"flat"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="xxyQwQ的个人博客">
<meta property="og:type" content="website">
<meta property="og:title" content="xxyQwQ">
<meta property="og:url" content="https://xxyqwq.github.io/index.html">
<meta property="og:site_name" content="xxyQwQ">
<meta property="og:description" content="xxyQwQ的个人博客">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="xxyQwQ">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://xxyqwq.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>xxyQwQ</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="xxyQwQ" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">xxyQwQ</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/xxyQwQ" class="github-corner" title="我的 Github" aria-label="我的 Github" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://xxyqwq.github.io/2024/02/14/junior-life/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="xxyQwQ">
      <meta itemprop="description" content="xxyQwQ的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="xxyQwQ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/02/14/junior-life/" class="post-title-link" itemprop="url">【文章】我的大三生活</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-02-14 18:43:27" itemprop="dateCreated datePublished" datetime="2024-02-14T18:43:27+08:00">2024-02-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-02-16 17:46:18" itemprop="dateModified" datetime="2024-02-16T17:46:18+08:00">2024-02-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%96%87%E7%AB%A0/" itemprop="url" rel="index"><span itemprop="name">文章</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="实验室实习"><a href="#实验室实习" class="headerlink" title="实验室实习"></a>实验室实习</h2><p>大二暑期的实验室实践课算是我第一次真正地参与实验室工作，由于专业课程还没有跟上，我对各个方向的了解也相当匮乏。根据一些道听途说的经验，我排除了已经相对完善的语音识别，过于内卷的计算机视觉，一夜之间被大模型颠覆的自然语言处理，选择了还不甚了解的强化学习。鉴于大家缺乏理论基础，老师安排我们以研讨会的形式学习David Silver的强化学习课程，剩余的时间再跟着学长开展工作。遗憾的是，学长给我分配的idea似乎很难奏效，当我确信这个idea缺乏创新性和实用性的时候，暑期实习已经接近尾声了，我在年底大致浏览了最新投稿的论文，也确实没有看到这方面的成果。现在想来，一个奏效的idea其实必须建立在自己深刻的理解之上，而非仅仅去尝试follow别人的工作，让缺乏指导经验的博士生带本科生其实也很不合理，无法实现循序渐进的有效培养。</p>
<p>一起实习的还有隔壁IEEE专业的卷王，他们申请了工位，每天泡在实验室里干活，甚至整个暑假都没有回家。这种勤奋给我留下了深刻的印象，也让我开始怀疑自己是否真的足够motivated，当然，我无法认同这种努力，我还是想给自己留出一段闲暇去陪一陪家人。相比那些忙于暑研的同学，我还是缺乏了一股狠劲，这也许就是我没能尽早产出论文的原因，然而在AI行业极度内卷的当下，即便有二作论文也未必会被认可。为了在申请留学时能够占据优势，每个人都急于在本科阶段发表顶会论文，崇尚潜心的学术变成了极尽功利的内卷，这恐怕是一种病态的追求。</p>
<h2 id="锐评专业课"><a href="#锐评专业课" class="headerlink" title="锐评专业课"></a>锐评专业课</h2><p>各种水课随着大三学年的到来烟消云散，只剩下几门核心专业课。《计算机视觉》和《自然语言处理》的授课以传统方法为主，而大作业却基于深度学习，难免有一些割裂感，但我仍能从经典算法中看到那个时代学者们理论的精妙和创新的智慧，感慨如今深度学习的如日中天和力大砖飞。IPADS实验室负责的《操作系统》则让我明显感受到课程设计的用心，从夏虞斌老师深入浅出的授课，到指导文档详实的实验作业，都为大家提供了极佳的学习体验，令人感叹不愧是世界顶尖的系统实验室。学术水平决定教学下限，思想态度决定教学上限，反观《生物信息学》，老师常年失踪，助教代理授课，一个研究生信的助教对着一群AI专业的学生讲机器学习，这种场景实在是有些好笑了。当然，作为一门水学分的课程，大家并不苛求能学到什么。《类脑智能》让我了解到脉冲神经网络和忆阻器计算的一些新方向，授课质量也算是中规中矩，而《人工智能前沿讲座》则是真正开拓眼界的一门课，能够在课堂上听到各路大佬分享学术见解和行业经验实在是弥足珍贵的，美中不足的是在时代的冲击下，讲座的主题清一色偏向于大语言模型，反而削减了领域的多样性。</p>
<h2 id="令人窒息的大作业"><a href="#令人窒息的大作业" class="headerlink" title="令人窒息的大作业"></a>令人窒息的大作业</h2><p>对于期末的大作业很多这件事，我是早有耳闻的，但唯有亲身经历才知道其中的艰辛。几乎所有的专业课都在期末布置了大作业，这本来无可厚非，但《计算机视觉》这种已经安排期末考试的课程也布置大作业实在是令人费解，有些大作业既要提交报告，又要上台答辩，严重增加了同学们的负担。这些大作业大多以小组合作的形式进行，但小组合作恰恰是最为低效的作业形式，一个超过两人的团队往往至少有一个人全程摸鱼，甚至绝大部分的任务都是由一名成员完成。这种形式在一定程度上利好懒惰不作为的人，但对于勤勤恳恳干活的人却是极不公平的。</p>
<p>考虑到既然大作业是考核的一部分，那就不妨做得完美一些，每篇报告都按照论文的格式来写，刚好可以锻炼自己学术写作的能力和熟练度。值得一提是《计算机视觉》的大作业，我们自选了一个手写汉字生成的任务，这个任务恰好可以利用《机器学习工程实践》中与AI换脸类似的框架来实现，我在原有的结构上稍作改进，很好地完成了这个任务。由于负责数据集处理和实验评估的同学都相当靠谱，这个难度最高的大作业反而完成得相当顺利，算是非常愉快的一次小组合作。当我完成所有六个大作业时，已经是第十八周的周末了，我以前从未在作业进度上如此狼狈。</p>
<h2 id="谈谈教育"><a href="#谈谈教育" class="headerlink" title="谈谈教育"></a>谈谈教育</h2><p>寒假期间，杜大佬在水源社区发了一篇帖子《交大本科就是个大型PUA修罗场》，引发了大家的共鸣，他在帖中写道：</p>
<blockquote>
<p>入学的时候，我起码是带着自信进校。开学典礼炫耀霸王课、挂科率、退学率，先给人当头一棒，除了恐吓人不知道能不能起到激励作用。你交讲“起点高，基础厚，要求严”传统，好像“我对你期望很高的，学不会都是你不努力”。通过各种“计划”、“试点班”筛选排名前X%，吃掉了所有的资源，让排名X%之后的同学觉得自己配不上交大，最终使得这些同学习惯了自己就是人下人，丧失了自信心和争取资源的主动性。当我以非前X%的成绩、没有任何“计划”、“试点班”帽子的状态毕业的时候，我觉得自己就配不上优秀，哪哪也比不上人。</p>
</blockquote>
<p>诚然，我们的本科教育早已畸形，它不是在培养人才，而是在筛选人才。交大的公众号三天两头地推送一些先进个人的故事，以唯成就论的视角歌颂刻板而单一的评价体系，而每个人自我实现的价值是不能被世俗的标准所定义的，那些不被聚光灯照耀的交大人也在默默地努力，更需要具有人文关怀的赞美。当室友着手准备托福考试的时候，我猛然感受到时间的飞逝，方才意识到自己也极大地受到了这一套评价体系的影响，过于在乎所谓的GPA，却忽视了更长远的规划。我似乎已经在这个泥潭中内卷了许久，是时候向下一个阶段进发了。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://xxyqwq.github.io/2024/01/27/build-windows-terminal/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="xxyQwQ">
      <meta itemprop="description" content="xxyQwQ的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="xxyQwQ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/27/build-windows-terminal/" class="post-title-link" itemprop="url">【文章】快速搭建Windows终端开发环境</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-01-27 10:43:22 / 修改时间：11:10:20" itemprop="dateCreated datePublished" datetime="2024-01-27T10:43:22+08:00">2024-01-27</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%96%87%E7%AB%A0/" itemprop="url" rel="index"><span itemprop="name">文章</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="安装应用"><a href="#安装应用" class="headerlink" title="安装应用"></a>安装应用</h2><p>Windows 11 自带 Windows Terminal，如果使用 Windows 10 需要先在 Microsoft Store 手动安装</p>
<p>最新版本的 oh-my-posh 也可以直接通过 Microsoft Store 安装，注意下载可能需要代理</p>
<p><img src="/images/build-windows-terminal/download.png" style="zoom: 50%;" /></p>
<h2 id="配置字体"><a href="#配置字体" class="headerlink" title="配置字体"></a>配置字体</h2><p>我们首先需要安装 <a target="_blank" rel="noopener" href="https://github.com/ryanoasis/nerd-fonts">Nerd Fonts</a> 以确保 oh-my-posh 中的字符和图标能够正常显示</p>
<p>各种字体可以直接在<a target="_blank" rel="noopener" href="https://www.nerdfonts.com/font-downloads">官网</a>下载，这里我们选用 CaskaydiaCove Nerd Font 作为演示，下载并安装字体后打开 Windows Terminal，在设置中选择 Windows PowerShell 的配置文件，在外观中修改字体并保存即可</p>
<h2 id="修改执行策略"><a href="#修改执行策略" class="headerlink" title="修改执行策略"></a>修改执行策略</h2><p>此外，我们需要修改 Windows PowerShell 的执行策略，使得 oh-my-posh 能够正确执行，以管理员身份运行 Windows PowerShell 执行命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ set-ExecutionPolicy RemoteSigned</span><br></pre></td></tr></table></figure>
<p>然后根据提示，将执行策略修改为是或全是</p>
<h2 id="创建配置文件"><a href="#创建配置文件" class="headerlink" title="创建配置文件"></a>创建配置文件</h2><p>现在我们为 Windows PowerShell 创建配置文件，在每次启动时都对 oh-my-posh 进行初始化</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ New-Item <span class="variable">$profile</span> -Value <span class="string">&quot;oh-my-posh init pwsh | Invoke-Expression&quot;</span> -Force</span><br></pre></td></tr></table></figure>
<p>重新打开 Windows Terminal，此时 oh-my-posh 已经可以正常启动</p>
<h2 id="更改主题"><a href="#更改主题" class="headerlink" title="更改主题"></a>更改主题</h2><p>接下来我们可以按需更换主题，以 Powerlevel10k 的 Rainbow Style 为例，首先执行命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Get-PoshThemes</span><br></pre></td></tr></table></figure>
<p>该命令会列出所有主题及其所在路径，根据提示我们可以定位到 <code>themes</code> 目录，将相应的主题文件复制到用户目录下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Copy-Item <span class="string">&quot;C:\Users\xxyQwQ\AppData\Local\Programs\oh-my-posh\themes\powerlevel10k_rainbow.omp.json&quot;</span> -Destination <span class="string">&quot;C:\Users\xxyQwQ&quot;</span> -Force</span><br></pre></td></tr></table></figure>
<p>根据提示修改创建的配置文件，在启动时加载主题</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ code <span class="variable">$profile</span></span><br><span class="line">oh-my-posh init pwsh --config <span class="string">&quot;C:\Users\xxyQwQ\powerlevel10k_rainbow.omp.json&quot;</span> | Invoke-Expression</span><br></pre></td></tr></table></figure>
<p>保存并重启 Windows Terminal，此时主题已经加载成功</p>
<h2 id="安装模块"><a href="#安装模块" class="headerlink" title="安装模块"></a>安装模块</h2><p>为了获得与 zsh 类似的使用体验，我们还需要额外安装一些模块，以管理员身份运行 Windows PowerShell 执行命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ Install-Module -Name PackageManagement -Repository PSGallery -Force</span><br><span class="line">$ Install-Module -Name PowerShellGet -Repository PSGallery -Force</span><br></pre></td></tr></table></figure>
<p>重启 Windows PowerShell，同样以管理员身份执行命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ Install-Module -Name PSReadLine -AllowPrerelease -Scope CurrentUser -Force -SkipPublisherCheck</span><br><span class="line">$ Install-Module -Name posh-git -AllowPrerelease -Scope CurrentUser -Force -SkipPublisherCheck</span><br></pre></td></tr></table></figure>
<p>模块安装完成后，在配置文件中添加如下命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ code <span class="variable">$profile</span></span><br><span class="line">Import-Module posh-git</span><br><span class="line">Import-Module PSReadLine</span><br><span class="line">Set-PSReadLineOption -PredictionSource History</span><br><span class="line">Set-PSReadLineKeyHandler -Chord <span class="string">&quot;Ctrl+RightArrow&quot;</span> -Function ForwardWord</span><br></pre></td></tr></table></figure>
<p>保存并重启 Windows Terminal，此时模块已经加载成功，此外 oh-my-posh 可以根据输入历史补全命令，使用 Ctrl+RightArrow 可以补全单词</p>
<h2 id="个性化设置"><a href="#个性化设置" class="headerlink" title="个性化设置"></a>个性化设置</h2><p>此外，我们也可以在配置文件中添加命令以支持更多个性化设置，例如</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Alias ll <span class="built_in">ls</span></span><br></pre></td></tr></table></figure>
<p>从而使得 oh-my-posh 更加符合 Linux 用户的使用习惯，一个完整的配置文件示例如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ code <span class="variable">$profile</span></span><br><span class="line">oh-my-posh init pwsh --config <span class="string">&quot;C:\Users\xxyQwQ\powerlevel10k_rainbow.omp.json&quot;</span> | Invoke-Expression</span><br><span class="line">Import-Module posh-git</span><br><span class="line">Import-Module PSReadLine</span><br><span class="line">Set-PSReadLineOption -PredictionSource History</span><br><span class="line">Set-PSReadLineKeyHandler -Chord <span class="string">&quot;Ctrl+RightArrow&quot;</span> -Function ForwardWord</span><br><span class="line">Set-Alias ll <span class="built_in">ls</span></span><br></pre></td></tr></table></figure>
<h2 id="配置-VSCode-终端"><a href="#配置-VSCode-终端" class="headerlink" title="配置 VSCode 终端"></a>配置 VSCode 终端</h2><p>最后，我们在 VSCode 中将默认配置文件改为 Windows PowerShell，并将终端字体改为 ‘CaskaydiaCove Nerd Font Mono’</p>
<p>至此，我们已经可以在 VSCode 中正常使用 oh-my-posh 作为终端</p>
<p><img src="/images/build-windows-terminal/showcase.png" style="zoom: 50%;" /></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://xxyqwq.github.io/2023/07/31/build-linux-terminal/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="xxyQwQ">
      <meta itemprop="description" content="xxyQwQ的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="xxyQwQ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/07/31/build-linux-terminal/" class="post-title-link" itemprop="url">【文章】快速搭建Linux终端开发环境</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2023-07-31 15:45:34 / 修改时间：19:34:53" itemprop="dateCreated datePublished" datetime="2023-07-31T15:45:34+08:00">2023-07-31</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%96%87%E7%AB%A0/" itemprop="url" rel="index"><span itemprop="name">文章</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p><code>VSCode</code>推出<code>Remote SSH</code>插件以后，远程开发变得简单，原生的开发环境大大提高了工作效率，但各种复杂的系统交互仍然需要回归终端。趁着近期有空折腾，笔者搜集各种资料，基于<code>zsh</code>+<code>oh-my-zsh</code>+<code>tmux</code>+<code>oh-my-tmux</code>搭建了一个相对令人满意的终端环境，本文用于整理搭建过程，构建一份搭建指南，以便日后读者参考</p>
<h2 id="环境要求"><a href="#环境要求" class="headerlink" title="环境要求"></a>环境要求</h2><ul>
<li><code>Linux</code>操作系统（笔者使用<code>Ubuntu 20.04</code>，其他版本可能略有差异）</li>
<li>用户具有<code>sudo</code>权限（安装依赖）</li>
<li>一些基本的工具（例如<code>curl</code>、<code>git</code>等）</li>
<li><strong>科学</strong>的网络环境（请自行配置代理工具）</li>
</ul>
<h2 id="搭建步骤"><a href="#搭建步骤" class="headerlink" title="搭建步骤"></a>搭建步骤</h2><h3 id="zsh"><a href="#zsh" class="headerlink" title="zsh"></a>zsh</h3><p>使用<code>apt</code>直接安装<code>zsh</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt install zsh</span><br></pre></td></tr></table></figure>
<p>检查<code>zsh</code>可用性</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cat</span> /etc/shells</span><br><span class="line"><span class="comment"># /etc/shells: valid login shells</span></span><br><span class="line">/usr/bin/zsh</span><br></pre></td></tr></table></figure>
<h3 id="oh-my-zsh"><a href="#oh-my-zsh" class="headerlink" title="oh-my-zsh"></a>oh-my-zsh</h3><p>使用<code>curl</code>安装<code>oh-my-zsh</code>，这里同样可以使用<code>wget</code>，具体参考<a target="_blank" rel="noopener" href="https://ohmyz.sh/">官网</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span></span><br><span class="line">$ sh -c <span class="string">&quot;<span class="subst">$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)</span>&quot;</span></span><br></pre></td></tr></table></figure>
<p>修改默认<code>shell</code>为<code>zsh</code>，然后重新登录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ chsh -s /bin/zsh</span><br></pre></td></tr></table></figure>
<p>检查默认<code>shell</code>是否已经正确修改</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$SHELL</span></span><br><span class="line">/bin/zsh</span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>：如果使用<code>VSCode</code>进行远程开发，需要额外进行以下操作</p>
<ul>
<li>在命令面板（<code>Ctrl</code>+<code>Shift</code>+<code>P</code>）中关闭服务器上的<code>vscode-server</code>进程</li>
<li>进入配置终端设置，将该服务器的默认终端修改为<code>zsh</code></li>
</ul>
<p>此处笔者使用<code>agnoster</code>主题，在<code>~/.zshrc</code>中修改配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ vim ~/.zshrc</span><br><span class="line">ZSH_THEME=<span class="string">&quot;agnoster&quot;</span></span><br></pre></td></tr></table></figure>
<p>从<code>Github</code>安装<code>zsh-autosuggestions</code>和<code>zsh-syntax-highlighting</code>插件，并在<code>~/.zshrc</code>中启用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-autosuggestions <span class="variable">$ZSH_CUSTOM</span>/plugins/zsh-autosuggestions</span><br><span class="line">$ git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-syntax-highlighting.git <span class="variable">$ZSH_CUSTOM</span>/plugins/zsh-syntax-highlighting</span><br><span class="line">$ vim ~/.zshrc</span><br><span class="line">plugins=(git zsh-autosuggestions zsh-syntax-highlighting)</span><br></pre></td></tr></table></figure>
<h3 id="tmux"><a href="#tmux" class="headerlink" title="tmux"></a>tmux</h3><p>使用<code>apt</code>直接安装<code>tmux</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt install tmux</span><br></pre></td></tr></table></figure>
<p>如果系统自带<code>tmux</code>，重启即可</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ tmux kill-server</span><br></pre></td></tr></table></figure>
<h3 id="oh-my-tmux"><a href="#oh-my-tmux" class="headerlink" title="oh-my-tmux"></a>oh-my-tmux</h3><p>从<code>Github</code>安装<code>oh-my-tmux</code>，这里笔者使用自己配置的版本，同样可以直接使用<a target="_blank" rel="noopener" href="https://github.com/gpakosz/.tmux">原版</a>，除了下载地址不同以外，安装过程完全相同</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span></span><br><span class="line">$ git <span class="built_in">clone</span> https://github.com/xxyQwQ/.tmux</span><br><span class="line">$ <span class="built_in">ln</span> -sf .tmux/.tmux.conf</span><br><span class="line">$ <span class="built_in">cp</span> .tmux/.tmux.conf.local .</span><br></pre></td></tr></table></figure>
<h2 id="其他事项"><a href="#其他事项" class="headerlink" title="其他事项"></a>其他事项</h2><h3 id="迁移bash配置"><a href="#迁移bash配置" class="headerlink" title="迁移bash配置"></a>迁移bash配置</h3><p>如果之前在<code>.bashrc</code>中进行了一些配置，可以将这些内容直接复制到<code>.zshrc</code>中</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ vim ~/.zshrc</span><br><span class="line"><span class="comment"># proxy setting</span></span><br><span class="line"><span class="keyword">if</span> [ -f /etc/profile.d/clash.sh ]; <span class="keyword">then</span></span><br><span class="line">    . /etc/profile.d/clash.sh</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<h3 id="关于Anaconda"><a href="#关于Anaconda" class="headerlink" title="关于Anaconda"></a>关于Anaconda</h3><p>如果使用<code>Anaconda</code>，建议关闭自动激活，否则在启动<code>tmux</code>时<code>PATH</code>变量可能错误加载，导致虚拟环境无法正常使用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ vim ~/.condarc</span><br><span class="line">auto_activate_base: <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<h3 id="改进外观"><a href="#改进外观" class="headerlink" title="改进外观"></a>改进外观</h3><p>笔者配置时注意到<code>zsh</code>和<code>tmux</code>中显示的主机名可能很长，可以通过修改配置文件的方式隐藏它们</p>
<p>对于<code>oh-my-zsh</code>，在<code>agnoster.zsh-theme</code>中做如下修改</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ vim ~/.oh-my-zsh/themes/agnoster.zsh-theme</span><br><span class="line"><span class="function"><span class="title">prompt_context</span></span>() &#123;</span><br><span class="line">  <span class="keyword">if</span> [[ <span class="string">&quot;<span class="variable">$USERNAME</span>&quot;</span> != <span class="string">&quot;<span class="variable">$DEFAULT_USER</span>&quot;</span> || -n <span class="string">&quot;<span class="variable">$SSH_CLIENT</span>&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">    prompt_segment black default <span class="string">&quot;%(!.%&#123;%F&#123;yellow&#125;%&#125;.)%n&quot;</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对于<code>oh-my-tmux</code>，在<code>~/.tmux.conf.local</code>中做如下修改</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ vim ~/.tmux.conf.local</span><br><span class="line">tmux_conf_theme_status_right=<span class="string">&quot; #&#123;prefix&#125;#&#123;mouse&#125;#&#123;pairing&#125;#&#123;synchronized&#125;#&#123;?battery_status,#&#123;battery_status&#125;,&#125;#&#123;?battery_bar, #&#123;battery_bar&#125;,&#125;#&#123;?battery_percentage, #&#123;battery_percentage&#125;,&#125; , %R , %d %b | #&#123;username&#125;#&#123;root&#125; &quot;</span></span><br></pre></td></tr></table></figure>
<p>至此，终端环境已经搭建完成，效果展示如下</p>
<p><img src="/images/build-linux-terminal/showcase.png" style="zoom: 50%;" /></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://xxyqwq.github.io/2023/06/20/support-vector-machine/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="xxyQwQ">
      <meta itemprop="description" content="xxyQwQ的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="xxyQwQ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/06/20/support-vector-machine/" class="post-title-link" itemprop="url">【文章】从零开始实现支持向量机</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-06-20 20:22:29" itemprop="dateCreated datePublished" datetime="2023-06-20T20:22:29+08:00">2023-06-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-06-21 00:31:31" itemprop="dateModified" datetime="2023-06-21T00:31:31+08:00">2023-06-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%96%87%E7%AB%A0/" itemprop="url" rel="index"><span itemprop="name">文章</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>这篇文章诞生于机器学习课程无聊的大作业，既然已经为此浪费了不少时间，不妨再多花点时间写一篇文章，借此记录一下实现过程。支持向量机的数学形式简约而直观，但一旦涉及具体实现，各种问题就会接踵而来。在本文中，笔者将首先推导SVM的主要公式，接着基于Platt-SMO算法，从零开始实现支持多种核函数的SVM，然后基于One-Versus-One策略实现多分类，最后在MNIST和CIFAR-10数据集上进行性能测试</p>
<h2 id="数学推导"><a href="#数学推导" class="headerlink" title="数学推导"></a>数学推导</h2><h3 id="基本形式"><a href="#基本形式" class="headerlink" title="基本形式"></a>基本形式</h3><p>给定一个训练集 $\mathcal{D} = \{(\boldsymbol{x}_i, y_i)\}_{i=1}^m$，其中 $\boldsymbol{x}_i \in \mathbb{R}^n$ 是特征向量，$y_i \in \{+1, -1\}$ 是标签。线性SVM期望找到一个超平面 $\boldsymbol{w}^T \boldsymbol{x} + b = 0$，将正样本和负样本分开，其中 $\boldsymbol{w} \in \mathbb{R}^n$ 是法向量，$b \in \mathbb{R}$ 是偏移量</p>
<p><img src="/images/support-vector-machine/SVM.jpg" style="zoom: 20%;" /></p>
<p>对于任一样本 $\boldsymbol{x}_i$，其到超平面的距离为</p>
<script type="math/tex; mode=display">r_i = \frac{|\boldsymbol{w}^T \boldsymbol{x}_i + b|}{\left\|\boldsymbol{w}\right\|}</script><p>假定该超平面能将正负样本完全分开，即对于任一样本 $\boldsymbol{x}_i$有</p>
<script type="math/tex; mode=display">\left\{\begin{aligned}
    &\boldsymbol{w}^T \boldsymbol{x}_i + b \geq +1, &y_i = +1 \\
    &\boldsymbol{w}^T \boldsymbol{x}_i + b \leq -1, &y_i = -1
\end{aligned}\right.</script><p>注意到有一些样本满足 $\boldsymbol{w}^T \boldsymbol{x}_i + b = \pm 1$，它们被称为支持向量。支持向量到超平面的距离被称为间隔，记为</p>
<script type="math/tex; mode=display">r = \frac{1}{\left\|\boldsymbol{w}\right\|}</script><p>我们的目标是最大化间隔，即最小化 $\left|\boldsymbol{w}\right|$。因此，优化问题可以表述为</p>
<script type="math/tex; mode=display">\begin{aligned}
&\min_{\boldsymbol{w}, b} \quad \frac{1}{2} \left\|\boldsymbol{w}\right\|^2 \\
&\text{s.t.} \quad y_i (\boldsymbol{w}^T \boldsymbol{x}_i + b) \geq 1, \quad i = 1, 2, \dots, m
\end{aligned}</script><p>然而，这些样本并不总是线性可分的，因此我们引入Hinge损失函数</p>
<script type="math/tex; mode=display">\ell_{\text{hinge}}(z) = \max\left\{0, 1 - z\right\}</script><p>于是，优化问题可以表述为</p>
<script type="math/tex; mode=display">\begin{aligned}
&\min_{\boldsymbol{w}, b} \quad \frac{1}{2} \left\|\boldsymbol{w}\right\|^2 + C \sum_{i=1}^m \ell_{\text{hinge}}[y_i (\boldsymbol{w}^T \boldsymbol{x}_i + b)] \\
&\text{s.t.} \quad \xi_i \geq 0, \quad i = 1, 2, \dots, m
\end{aligned}</script><p>如果我们引入松弛变量 $\xi_i \geq 0$，优化问题可以改写为</p>
<script type="math/tex; mode=display">\begin{aligned}
&\min_{\boldsymbol{w}, b} \quad \frac{1}{2} \left\|\boldsymbol{w}\right\|^2 + C \sum_{i=1}^m \xi_i \\
&\text{s.t.} \quad y_i (\boldsymbol{w}^T \boldsymbol{x}_i + b) \geq 1 - \xi_i, \quad i = 1, 2, \dots, m
\end{aligned}</script><p>为了构造对偶问题，我们引入拉格朗日乘子 $\alpha_i \geq 0$ 和 $\mu_i \geq 0$，拉格朗日函数定义为</p>
<script type="math/tex; mode=display">\mathcal{L}(\boldsymbol{w}, b, \boldsymbol{\xi}, \boldsymbol{\alpha}, \boldsymbol{\mu}) = \frac{1}{2} \left\|\boldsymbol{w}\right\|^2 + C \sum_{i=1}^m \xi_i - \sum_{i=1}^m \alpha_i [y_i (\boldsymbol{w}^T \boldsymbol{x}_i + b) - 1 + \xi_i] - \sum_{i=1}^m \mu_i \xi_i</script><p>令 $\mathcal{L}$ 对 $\boldsymbol{w}$，$b$ 和 $\xi_i$ 的偏导数为零，可得</p>
<script type="math/tex; mode=display">\begin{aligned}
\frac{\partial \mathcal{L}}{\partial \boldsymbol{w}} &= \boldsymbol{w} - \sum_{i=1}^m \alpha_i y_i \boldsymbol{x}_i = 0 \\
\frac{\partial \mathcal{L}}{\partial b} &= -\sum_{i=1}^m \alpha_i y_i = 0 \\
\frac{\partial \mathcal{L}}{\partial \xi_i} &= C - \alpha_i - \mu_i = 0
\end{aligned}</script><p>因此，对偶问题可以表述为</p>
<script type="math/tex; mode=display">\begin{aligned}
&\max_{\boldsymbol{\alpha}} \quad \sum_{i=1}^m \alpha_i - \frac{1}{2} \sum_{i=1}^m \sum_{j=1}^m \alpha_i \alpha_j y_i y_j \boldsymbol{x}_i^T \boldsymbol{x}_j \\
&\text{s.t.} \quad \sum_{i=1}^m \alpha_i y_i = 0 \\
&\quad \quad 0 \leq \alpha_i \leq C, \quad i = 1, 2, \dots, m
\end{aligned}</script><p>这是一个二次规划问题，我们可以采用梯度下降或者坐标下降等方法求解。</p>
<h3 id="核函数与核技巧"><a href="#核函数与核技巧" class="headerlink" title="核函数与核技巧"></a>核函数与核技巧</h3><p>有时候这些样本并不是线性可分的，但是我们可以将它们映射到高维空间，使得它们在高维空间中线性可分。假定映射函数为 $\phi$，则样本 $\boldsymbol{x}_i$ 被映射到 $\phi(\boldsymbol{x}_i)$。我们可以将对偶问题改写为</p>
<script type="math/tex; mode=display">\begin{aligned}
&\max_{\boldsymbol{\alpha}} \quad \sum_{i=1}^m \alpha_i - \frac{1}{2} \sum_{i=1}^m \sum_{j=1}^m \alpha_i \alpha_j y_i y_j \phi(\boldsymbol{x}_i)^T \phi(\boldsymbol{x}_j) \\
&\text{s.t.} \quad \sum_{i=1}^m \alpha_i y_i = 0 \\
&\quad \quad 0 \leq \alpha_i \leq C, \quad i = 1, 2, \dots, m
\end{aligned}</script><p>有趣的是，我们并不需要显式地计算 $\phi(\boldsymbol{x}_i)$，而是通过核函数 $K(\boldsymbol{x}_i, \boldsymbol{x}_j) = \phi(\boldsymbol{x}_i)^T \phi(\boldsymbol{x}_j)$ 来计算内积，因此对偶问题可以改写为</p>
<script type="math/tex; mode=display">\begin{aligned}
&\max_{\boldsymbol{\alpha}} \quad \sum_{i=1}^m \alpha_i - \frac{1}{2} \sum_{i=1}^m \sum_{j=1}^m \alpha_i \alpha_j y_i y_j K(\boldsymbol{x}_i, \boldsymbol{x}_j) \\
&\text{s.t.} \quad \sum_{i=1}^m \alpha_i y_i = 0 \\
&\quad \quad 0 \leq \alpha_i \leq C, \quad i = 1, 2, \dots, m
\end{aligned}</script><p>这种方法也称为核技巧（Kernel Trick），下面我们给出几种常用的核函数</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">核函数</th>
<th style="text-align:center">$\kappa(\boldsymbol{x}_i, \boldsymbol{x}_j)$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">线性核</td>
<td style="text-align:center">$\boldsymbol{x}_i^T \boldsymbol{x}_j$</td>
</tr>
<tr>
<td style="text-align:center">多项式核</td>
<td style="text-align:center">$(\gamma \boldsymbol{x}_i^T \boldsymbol{x}_j + r)^d$</td>
</tr>
<tr>
<td style="text-align:center">高斯核</td>
<td style="text-align:center">$\exp(-\gamma \vert\boldsymbol{x}_i - \boldsymbol{x}_j\vert^2)$</td>
</tr>
<tr>
<td style="text-align:center">Sigmoid核</td>
<td style="text-align:center">$\tanh(\gamma \boldsymbol{x}_i^T \boldsymbol{x}_j + r)$</td>
</tr>
</tbody>
</table>
</div>
<h3 id="Platt-SMO算法"><a href="#Platt-SMO算法" class="headerlink" title="Platt-SMO算法"></a>Platt-SMO算法</h3><p>Platt-SMO算法来源于坐标下降法，每次只尝试优化一个变量。由于对偶问题中存在约束，我们每次需要优化两个变量。假设我们选择 $\alpha_1$ 和 $\alpha_2$ 来优化，固定其他变量，优化问题可以表述为</p>
<script type="math/tex; mode=display">\begin{aligned}
    \max_{\alpha_1, \alpha_2} \quad &\alpha_1 + \alpha_2 - \alpha_1 \alpha_2 y_1 y_2 \kappa(\boldsymbol{x}_1, \boldsymbol{x}_2) \\
    &- \frac{1}{2} \alpha_1^2 y_1^2 \kappa(\boldsymbol{x}_1, \boldsymbol{x}_1) - \frac{1}{2} \alpha_2^2 y_2^2 \kappa(\boldsymbol{x}_2, \boldsymbol{x}_2) \\
    &- \alpha_1 y_1 \sum_{i=3}^m \alpha_i y_i \kappa(\boldsymbol{x}_1, \boldsymbol{x}_i) - \alpha_2 y_2 \sum_{i=3}^m \alpha_i y_i \kappa(\boldsymbol{x}_2, \boldsymbol{x}_i) \\
    \text{s.t.} \quad &\alpha_1 y_1 + \alpha_2 y_2 = -\sum_{i=3}^m \alpha_i y_i = \zeta \\
    &0 \leq \alpha_1 \leq C, \quad 0 \leq \alpha_2 \leq C
\end{aligned}</script><p>其中 $\zeta$ 是一个常数，我们可以将 $\alpha_1$ 表示为</p>
<script type="math/tex; mode=display">\alpha_1 = \zeta y_1 - \alpha_2 y_1 y_2</script><p>决策函数可以表示为</p>
<script type="math/tex; mode=display">f(\boldsymbol{x})=\sum_{i=1}^m \alpha_i y_i \kappa(\boldsymbol{x}_i, \boldsymbol{x}) + b</script><p>令 $E_i=f(\boldsymbol{x}_i)-y_i$ 表示预测值与真实值之间的误差。定义辅助变量 $v_1$ 和 $v_2$ 为</p>
<script type="math/tex; mode=display">\begin{aligned}
    v_1&=\sum \limits_{i=3}^m \alpha_i y_i \kappa(\boldsymbol{x}_1, \boldsymbol{x}_i) \\
    &=f(\boldsymbol{x}_1) - b - \alpha_1 y_1 \kappa(\boldsymbol{x}_1, \boldsymbol{x}_1) - \alpha_2 y_2 \kappa(\boldsymbol{x}_1, \boldsymbol{x}_2) \\
    v_2&=\sum \limits_{i=3}^m \alpha_i y_i \kappa(\boldsymbol{x}_2, \boldsymbol{x}_i) \\
    &=f(\boldsymbol{x}_2) - b - \alpha_1 y_1 \kappa(\boldsymbol{x}_1, \boldsymbol{x}_2) - \alpha_2 y_2 \kappa(\boldsymbol{x}_2, \boldsymbol{x}_2)
\end{aligned}</script><p>于是目标函数可以写成</p>
<script type="math/tex; mode=display">\begin{aligned}
    \mathcal{L}(\alpha_2) &= -\alpha_2 (\zeta - \alpha_2 y_2) y_2 \kappa(\boldsymbol{x}_1, \boldsymbol{x}_2) \\
    &- \frac{1}{2} (\zeta - \alpha_2 y_2)^2 \kappa(\boldsymbol{x}_1, \boldsymbol{x}_1) - \frac{1}{2} \alpha_2^2 \kappa(\boldsymbol{x}_2, \boldsymbol{x}_2) \\
    &-(\zeta - \alpha_2 y_2) v_1 - \alpha_2 y_2 v_2 + (1 - y_1 y_2) \alpha_2
\end{aligned}</script><p>令 $\mathcal{L}$ 对 $\alpha_2$ 的偏导数为零，可得</p>
<script type="math/tex; mode=display">\begin{aligned}
    \frac{\partial \mathcal{L}}{\partial \alpha_2} &= -(\kappa(\boldsymbol{x}_1, \boldsymbol{x}_1) + \kappa(\boldsymbol{x}_2, \boldsymbol{x}_2) - 2 \kappa(\boldsymbol{x}_1, \boldsymbol{x}_2)) \alpha_2 \\
    &+ y_2 \zeta (\kappa(\boldsymbol{x}_1, \boldsymbol{x}_1) - \kappa(\boldsymbol{x}_1, \boldsymbol{x}_2)) \\
    &+ (v_1 - v_2) y_2 - y_1 y_2 + y_2^2 = 0
\end{aligned}</script><p>令 $\eta = \kappa(\boldsymbol{x}_1, \boldsymbol{x}_1) + \kappa(\boldsymbol{x}_2, \boldsymbol{x}_2) - 2 \kappa(\boldsymbol{x}_1, \boldsymbol{x}_2)$，注意到</p>
<script type="math/tex; mode=display">v_1 - v_2 = f(\boldsymbol{x}_1) - f(\boldsymbol{x}_2) + \alpha_2 y_2 \eta - \zeta (\kappa(\boldsymbol{x}_1, \boldsymbol{x}_1) - \kappa(\boldsymbol{x}_1, \boldsymbol{x}_2))</script><p>于是有</p>
<script type="math/tex; mode=display">\frac{\partial \mathcal{L}}{\partial \alpha_2} = -\eta \alpha_2^* + \eta \alpha_2 + y_2 (E_1 - E_2) = 0</script><p>因此</p>
<script type="math/tex; mode=display">\alpha_2^* = \alpha_2 + \frac{y_2 (E_1 - E_2)}{\eta}</script><p>由于存在约束条件 $0 \leq \alpha_1,\alpha_2 \leq C$，因此需要对 $\alpha_2^*$ 进行修剪</p>
<script type="math/tex; mode=display">\alpha'_2 = \left\{ \begin{aligned}
    &L, &\alpha_2^* < L \\
    &\alpha_2^*, &L \leq \alpha_2^* \leq H \\
    &H, &\alpha_2^* > H \\
\end{aligned} \right.</script><p>其中</p>
<script type="math/tex; mode=display">\begin{aligned}
    L &= \left\{ \begin{aligned}
        &\max \{0, \alpha_2 + \alpha_1 - C\}, &y_1=y_2 \\
        &\max \{0, \alpha_2 - \alpha_1\}, &y_1 \neq y_2 \\
    \end{aligned} \right. \\
    H &= \left\{ \begin{aligned}
        &\min \{C, \alpha_2 + \alpha_1\}, &y_1=y_2 \\
        &\min \{C, C + \alpha_2 - \alpha_1\}, &y_1 \neq y_2 \\
    \end{aligned} \right.
\end{aligned}</script><p>于是 $\alpha_1$ 可以通过 $\alpha_2$ 来计算</p>
<script type="math/tex; mode=display">\alpha'_1 = \alpha_1 + y_1 y_2 (\alpha_2 - \alpha'_2)</script><p>如果 $0 &lt; \alpha_i &lt; C$，则 $\boldsymbol{x}_i$ 是支持向量，辅助变量 $b_1$ 和 $b_2$ 定义为</p>
<script type="math/tex; mode=display">\begin{aligned}
    b_1 &= b - E_1 - y_1 \kappa(\boldsymbol{x}_1, \boldsymbol{x}_1) (\alpha'_1 - \alpha_1) - y_2 \kappa(\boldsymbol{x}_1, \boldsymbol{x}_2) (\alpha'_2 - \alpha_2) \\
    b_2 &= b - E_2 - y_1 \kappa(\boldsymbol{x}_1, \boldsymbol{x}_2) (\alpha'_1 - \alpha_1) - y_2 \kappa(\boldsymbol{x}_2, \boldsymbol{x}_2) (\alpha'_2 - \alpha_2)
\end{aligned}</script><p>因此，偏移量 $b$ 的更新规则为</p>
<script type="math/tex; mode=display">b = \left\{ \begin{aligned}
    &b_1, &0 < \alpha'_1 < C \\
    &b_2, &0 < \alpha'_2 < C \\
    &\frac{b_1 + b_2}{2}, &\text{otherwise}
\end{aligned} \right.</script><p>现在我们已经得到了单次迭代中所有参数的更新公式，我们只需要反复地选择一对 $\alpha_i$ 和 $\alpha_j$ 进行更新，直到收敛为止</p>
<h2 id="算法实现"><a href="#算法实现" class="headerlink" title="算法实现"></a>算法实现</h2><h3 id="核函数"><a href="#核函数" class="headerlink" title="核函数"></a>核函数</h3><p>我们对上述四种核函数进行实现，这里将核函数封装成类，通过实现<code>__call__</code>方法，使其实例可以像函数一样被调用</p>
<ol>
<li><p>线性核</p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LinearKernel</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.name = <span class="string">&#x27;linear&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self, X, y</span>):</span><br><span class="line">        <span class="keyword">return</span> X @ y.T</span><br></pre></td></tr></table></figure>
</li>
<li><p>多项式核</p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PolynomialKernel</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, gamma=<span class="number">1.0</span>, degree=<span class="number">3</span></span>):</span><br><span class="line">        self.name = <span class="string">&#x27;polynomial&#x27;</span></span><br><span class="line">        self.gamma = gamma</span><br><span class="line">        self.degree = degree</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self, X, y</span>):</span><br><span class="line">        <span class="keyword">return</span> np.power(self.gamma * (X @ y.T) + <span class="number">1</span>, self.degree)</span><br></pre></td></tr></table></figure>
</li>
<li><p>高斯核</p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">GaussianKernel</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, gamma=<span class="number">1.0</span></span>):</span><br><span class="line">        self.name = <span class="string">&#x27;gaussian&#x27;</span></span><br><span class="line">        self.gamma = gamma</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self, X, y</span>):</span><br><span class="line">        <span class="keyword">return</span> np.exp(-self.gamma * np.<span class="built_in">sum</span>(np.square(X - y), axis=<span class="number">1</span>))</span><br></pre></td></tr></table></figure>
</li>
<li><p>Sigmod核</p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SigmoidKernel</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, gamma=<span class="number">1.0</span>, bias=<span class="number">0.0</span></span>):</span><br><span class="line">        self.name = <span class="string">&#x27;sigmoid&#x27;</span></span><br><span class="line">        self.gamma = gamma</span><br><span class="line">        self.bias = bias</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self, X, y</span>):</span><br><span class="line">        <span class="keyword">return</span> np.tanh(self.gamma * (X @ y.T) + self.bias)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>另外，我们定义一个工具函数，方便核函数的创建</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">CreateKernel</span>(<span class="params">entry</span>):</span><br><span class="line">    <span class="keyword">if</span> entry[<span class="string">&#x27;name&#x27;</span>] == <span class="string">&#x27;linear&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> LinearKernel()</span><br><span class="line">    <span class="keyword">elif</span> entry[<span class="string">&#x27;name&#x27;</span>] == <span class="string">&#x27;polynomial&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> PolynomialKernel(entry[<span class="string">&#x27;gamma&#x27;</span>], entry[<span class="string">&#x27;degree&#x27;</span>])</span><br><span class="line">    <span class="keyword">elif</span> entry[<span class="string">&#x27;name&#x27;</span>] == <span class="string">&#x27;gaussian&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> GaussianKernel(entry[<span class="string">&#x27;gamma&#x27;</span>])</span><br><span class="line">    <span class="keyword">elif</span> entry[<span class="string">&#x27;name&#x27;</span>] == <span class="string">&#x27;sigmoid&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> SigmoidKernel(entry[<span class="string">&#x27;gamma&#x27;</span>], entry[<span class="string">&#x27;bias&#x27;</span>])</span><br><span class="line">    <span class="keyword">raise</span> AttributeError(<span class="string">&#x27;invalid kernel&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="支持向量机"><a href="#支持向量机" class="headerlink" title="支持向量机"></a>支持向量机</h3><p>参考<code>scikit-learn</code>的封装，我们定义一个类，提供<code>fit</code>和<code>predict</code>两种方法，参数包括最大迭代次数、惩罚系数、误差精度和核函数类型，利用私有函数实现 $\alpha_i$ 和 $\alpha_j$ 的选择和单步更新，对于线性核，我们提供<code>weight</code>属性，用于获取线性核的分类超平面参数，除了一些简化以外，代码基本按照Platt-SMO算法进行实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SupportVectorMachine</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, iteration=<span class="number">100</span>, penalty=<span class="number">1.0</span>, epsilon=<span class="number">1e-6</span>, kernel=<span class="literal">None</span></span>):</span><br><span class="line">        self.iteration = iteration</span><br><span class="line">        self.penalty = penalty</span><br><span class="line">        self.epsilon = epsilon</span><br><span class="line">        <span class="keyword">if</span> kernel <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            kernel = &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;linear&#x27;</span>&#125;</span><br><span class="line">        self.kernel = CreateKernel(kernel)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__compute_w</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (self.a * self.y) @ self.X</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__compute_e</span>(<span class="params">self, i</span>):</span><br><span class="line">        <span class="keyword">return</span> (self.a * self.y) @ self.K[:, i] + self.b - self.y[i]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__select_j</span>(<span class="params">self, i</span>):</span><br><span class="line">        j = np.random.randint(<span class="number">1</span>, self.m)</span><br><span class="line">        <span class="keyword">return</span> j <span class="keyword">if</span> j &gt; i <span class="keyword">else</span> j - <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__step_forward</span>(<span class="params">self, i</span>):</span><br><span class="line">        e_i = self.__compute_e(i)</span><br><span class="line">        <span class="keyword">if</span> ((self.a[i] &gt; <span class="number">0</span>) <span class="keyword">and</span> (e_i * self.y[i] &gt; self.epsilon)) <span class="keyword">or</span> ((self.a[i] &lt; self.penalty) <span class="keyword">and</span> (e_i * self.y[i] &lt; -self.epsilon)):</span><br><span class="line">            j = self.__select_j(i)</span><br><span class="line">            e_j = self.__compute_e(j)</span><br><span class="line">            a_i, a_j = np.copy(self.a[i]), np.copy(self.a[j])</span><br><span class="line">            <span class="keyword">if</span> self.y[i] == self.y[j]:</span><br><span class="line">                L = <span class="built_in">max</span>(<span class="number">0</span>, a_i + a_j - self.penalty)</span><br><span class="line">                H = <span class="built_in">min</span>(self.penalty, a_i + a_j)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                L = <span class="built_in">max</span>(<span class="number">0</span>, a_j - a_i)</span><br><span class="line">                H = <span class="built_in">min</span>(self.penalty, self.penalty + a_j - a_i)</span><br><span class="line">            <span class="keyword">if</span> L == H:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            d = <span class="number">2</span> * self.K[i, j] - self.K[i, i] - self.K[j, j]</span><br><span class="line">            <span class="keyword">if</span> d &gt;= <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            self.a[j] = np.clip(a_j - self.y[j] * (e_i - e_j) / d, L, H)</span><br><span class="line">            <span class="keyword">if</span> np.<span class="built_in">abs</span>(self.a[j] - a_j) &lt; self.epsilon:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            self.a[i] = a_i + self.y[i] * self.y[j] * (a_j - self.a[j])</span><br><span class="line">            b_i = self.b - e_i - self.y[i] * self.K[i, i] * (self.a[i] - a_i) - self.y[j] * self.K[j, i] * (self.a[j] - a_j)</span><br><span class="line">            b_j = self.b - e_j - self.y[i] * self.K[i, j] * (self.a[i] - a_i) - self.y[j] * self.K[j, j] * (self.a[j] - a_j)</span><br><span class="line">            <span class="keyword">if</span> <span class="number">0</span> &lt; self.a[i] &lt; self.penalty:</span><br><span class="line">                self.b = b_i</span><br><span class="line">            <span class="keyword">elif</span> <span class="number">0</span> &lt; self.a[j] &lt; self.penalty:</span><br><span class="line">                self.b = b_j</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.b = (b_i + b_j) / <span class="number">2</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setup</span>(<span class="params">self, X, y</span>):</span><br><span class="line">        self.X, self.y = X, y</span><br><span class="line">        self.m, self.n = X.shape</span><br><span class="line">        self.b = <span class="number">0.0</span></span><br><span class="line">        self.a = np.zeros(self.m)</span><br><span class="line">        self.K = np.zeros((self.m, self.m))</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.m):</span><br><span class="line">            self.K[:, i] = self.kernel(X, X[i, :])</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">fit</span>(<span class="params">self, X, y</span>):</span><br><span class="line">        self.setup(X, y)</span><br><span class="line">        entire = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(self.iteration):</span><br><span class="line">            change = <span class="number">0</span></span><br><span class="line">            <span class="keyword">if</span> entire:</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.m):</span><br><span class="line">                    change += self.__step_forward(i)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                index = np.nonzero((<span class="number">0</span> &lt; self.a) * (self.a &lt; self.penalty))[<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> index:</span><br><span class="line">                    change += self.__step_forward(i)</span><br><span class="line">            <span class="keyword">if</span> entire:</span><br><span class="line">                entire = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">elif</span> change == <span class="number">0</span>:</span><br><span class="line">                entire = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">predict</span>(<span class="params">self, X</span>):</span><br><span class="line">        m = X.shape[<span class="number">0</span>]</span><br><span class="line">        y = np.zeros(m)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">            y[i] = np.sign((self.a * self.y) @ self.kernel(self.X, X[i, :]) + self.b)</span><br><span class="line">        <span class="keyword">return</span> y</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">weight</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.kernel.name != <span class="string">&#x27;linear&#x27;</span>:</span><br><span class="line">            <span class="keyword">raise</span> AttributeError(<span class="string">&#x27;non-linear kernel&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> self.__compute_w(), self.b</span><br></pre></td></tr></table></figure>
<h3 id="多分类"><a href="#多分类" class="headerlink" title="多分类"></a>多分类</h3><p>基于One-Versus-One策略，我们构造 $C_k^2$ 个SVM，其中 $k$ 为类别数，训练每个分类器时，选取相应类别的样本作为训练集，并将标签映射到 $-1$ 和 $1$，在预测时，用每个分类器的预测结果进行投票，从而得到最终结果</p>
<p>我们采用与支持向量机完全相同的封装，提供<code>fit</code>和<code>predict</code>两种方法，使该类成为通用的分类模型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SupportVectorClassifier</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, iteration=<span class="number">100</span>, penalty=<span class="number">1.0</span>, epsilon=<span class="number">1e-6</span>, kernel=<span class="literal">None</span></span>):</span><br><span class="line">        self.iteration = iteration</span><br><span class="line">        self.penalty = penalty</span><br><span class="line">        self.epsilon = epsilon</span><br><span class="line">        self.kernel = kernel</span><br><span class="line">        self.classifier = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__build_model</span>(<span class="params">self, y</span>):</span><br><span class="line">        self.label = np.unique(y)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(self.label)):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>, <span class="built_in">len</span>(self.label)):</span><br><span class="line">                model = SupportVectorMachine(self.iteration, self.penalty, self.epsilon, self.kernel)</span><br><span class="line">                self.classifier.append((i, j, model))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">fit</span>(<span class="params">self, X, y</span>):</span><br><span class="line">        self.__build_model(y)</span><br><span class="line">        <span class="keyword">for</span> i, j, model <span class="keyword">in</span> tqdm(self.classifier):</span><br><span class="line">            index = np.where((y == self.label[i]) | (y == self.label[j]))[<span class="number">0</span>]</span><br><span class="line">            X_ij, y_ij = X[index], np.where(y[index] == self.label[i], -<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">            model.fit(X_ij, y_ij)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">predict</span>(<span class="params">self, X</span>):</span><br><span class="line">        vote = np.zeros((X.shape[<span class="number">0</span>], <span class="built_in">len</span>(self.label)))</span><br><span class="line">        <span class="keyword">for</span> i, j, model <span class="keyword">in</span> tqdm(self.classifier):</span><br><span class="line">            y = model.predict(X)</span><br><span class="line">            vote[np.where(y == -<span class="number">1</span>)[<span class="number">0</span>], i] += <span class="number">1</span></span><br><span class="line">            vote[np.where(y == <span class="number">1</span>)[<span class="number">0</span>], j] += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> self.label[np.argmax(vote, axis=<span class="number">1</span>)]</span><br></pre></td></tr></table></figure>
<h2 id="性能测试"><a href="#性能测试" class="headerlink" title="性能测试"></a>性能测试</h2><p>首先，我们在二维平面上构造两组简单的正态分布数据，用于可视化支持向量机的分类效果，首先构造数据并训练模型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">X = np.concatenate((np.random.randn(<span class="number">500</span>, <span class="number">2</span>) - <span class="number">2</span>, np.random.randn(<span class="number">500</span>, <span class="number">2</span>) + <span class="number">2</span>))</span><br><span class="line">y = np.concatenate((np.ones(<span class="number">500</span>), -np.ones(<span class="number">500</span>)))</span><br><span class="line">C = SupportVectorMachine(iteration=<span class="number">100</span>)</span><br><span class="line">C.fit(X, y)</span><br><span class="line">w, b = C.weight</span><br><span class="line">u = np.linspace(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">100</span>)</span><br><span class="line">v = (-b - w[<span class="number">0</span>] * u) / w[<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<p>然后根据模型参数绘制分类效果<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">plt.scatter(X[:<span class="number">500</span>, <span class="number">0</span>], X[:<span class="number">500</span>, <span class="number">1</span>], label=<span class="string">&#x27;Positive&#x27;</span>)</span><br><span class="line">plt.scatter(X[<span class="number">500</span>:, <span class="number">0</span>], X[<span class="number">500</span>:, <span class="number">1</span>], label=<span class="string">&#x27;Negative&#x27;</span>)</span><br><span class="line">plt.plot(u, v, label=<span class="string">&#x27;Separation&#x27;</span>, c=<span class="string">&#x27;g&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;$x$&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;$y$&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Separation Sample&#x27;</span>)</span><br><span class="line">plt.grid()</span><br><span class="line">plt.legend()</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.savefig(<span class="string">&#x27;./figure/separation.png&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure></p>
<p>可以看到，我们实现的SVM可以很好地将两组数据分开</p>
<p><img src="/images/support-vector-machine/separation.png" style="zoom: 75%;" /></p>
<p>为了在MNIST和CIFAR-10数据集上测试性能，需要对数据进行预处理，这里我们将图像展开为向量，并将像素值归一化到 $[0, 1]$ 区间，对于MNIST数据集我们仅保留 $5000$ 个训练样本和 $1000$ 个测试样本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">MNIST</span>(<span class="params">path, group=<span class="string">&#x27;train&#x27;</span></span>):</span><br><span class="line">    <span class="keyword">if</span> group == <span class="string">&#x27;train&#x27;</span>:</span><br><span class="line">        <span class="keyword">with</span> gzip.<span class="built_in">open</span>(os.path.join(path, <span class="string">&#x27;train-images-idx3-ubyte.gz&#x27;</span>), <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            image = np.frombuffer(file.read(), np.uint8, offset=<span class="number">16</span>).reshape(-<span class="number">1</span>, <span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>) / <span class="number">255.0</span></span><br><span class="line">        <span class="keyword">with</span> gzip.<span class="built_in">open</span>(os.path.join(path, <span class="string">&#x27;train-labels-idx1-ubyte.gz&#x27;</span>), <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            label = np.frombuffer(file.read(), np.uint8, offset=<span class="number">8</span>)</span><br><span class="line">    <span class="keyword">elif</span> group == <span class="string">&#x27;test&#x27;</span>:</span><br><span class="line">        <span class="keyword">with</span> gzip.<span class="built_in">open</span>(os.path.join(path, <span class="string">&#x27;t10k-images-idx3-ubyte.gz&#x27;</span>), <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            image = np.frombuffer(file.read(), np.uint8, offset=<span class="number">16</span>).reshape(-<span class="number">1</span>, <span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>) / <span class="number">255.0</span></span><br><span class="line">        <span class="keyword">with</span> gzip.<span class="built_in">open</span>(os.path.join(path, <span class="string">&#x27;t10k-labels-idx1-ubyte.gz&#x27;</span>), <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            label = np.frombuffer(file.read(), np.uint8, offset=<span class="number">8</span>)</span><br><span class="line">    remain = <span class="number">500</span> <span class="keyword">if</span> group == <span class="string">&#x27;train&#x27;</span> <span class="keyword">else</span> <span class="number">100</span></span><br><span class="line">    image_list, label_list = [], []</span><br><span class="line">    <span class="keyword">for</span> value <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        index = np.where(label == value)[<span class="number">0</span>][:remain]</span><br><span class="line">        image_list.append(image[index])</span><br><span class="line">        label_list.append(label[index])</span><br><span class="line">    image, label = np.concatenate(image_list), np.concatenate(label_list)</span><br><span class="line">    index = np.random.permutation(<span class="built_in">len</span>(label))</span><br><span class="line">    <span class="keyword">return</span> image[index], label[index]</span><br></pre></td></tr></table></figure>
<p>对于CIFAR10数据集，我们做同样的处理<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">CIFAR10</span>(<span class="params">path, group=<span class="string">&#x27;train&#x27;</span></span>):</span><br><span class="line">    <span class="keyword">if</span> group == <span class="string">&#x27;train&#x27;</span>:</span><br><span class="line">        image_list, label_list = [], []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">6</span>):</span><br><span class="line">            filename = os.path.join(path, <span class="string">&#x27;data_batch_&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(i))</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">                data = pickle.load(file, encoding=<span class="string">&#x27;bytes&#x27;</span>)</span><br><span class="line">            image_list.append(np.array(data[<span class="string">b&#x27;data&#x27;</span>], dtype=np.float32).reshape(-<span class="number">1</span>, <span class="number">3</span>, <span class="number">32</span>, <span class="number">32</span>) / <span class="number">255.0</span>)</span><br><span class="line">            label_list.append(np.array(data[<span class="string">b&#x27;labels&#x27;</span>], dtype=np.int32))</span><br><span class="line">        image, label = np.concatenate(image_list), np.concatenate(label_list)</span><br><span class="line">    <span class="keyword">elif</span> group == <span class="string">&#x27;test&#x27;</span>:</span><br><span class="line">        filename = os.path.join(path, <span class="string">&#x27;test_batch&#x27;</span>)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            data = pickle.load(file, encoding=<span class="string">&#x27;bytes&#x27;</span>)</span><br><span class="line">        image = np.array(data[<span class="string">b&#x27;data&#x27;</span>], dtype=np.float32).reshape(-<span class="number">1</span>, <span class="number">3</span>, <span class="number">32</span>, <span class="number">32</span>) / <span class="number">255.0</span></span><br><span class="line">        label = np.array(data[<span class="string">b&#x27;labels&#x27;</span>], dtype=np.int32)</span><br><span class="line">    remain = <span class="number">500</span> <span class="keyword">if</span> group == <span class="string">&#x27;train&#x27;</span> <span class="keyword">else</span> <span class="number">100</span></span><br><span class="line">    image_list, label_list = [], []</span><br><span class="line">    <span class="keyword">for</span> value <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        index = np.where(label == value)[<span class="number">0</span>][:remain]</span><br><span class="line">        image_list.append(image[index])</span><br><span class="line">        label_list.append(label[index])</span><br><span class="line">    image, label = np.concatenate(image_list), np.concatenate(label_list)</span><br><span class="line">    index = np.random.permutation(<span class="built_in">len</span>(label))</span><br><span class="line">    <span class="keyword">return</span> image[index], label[index]</span><br></pre></td></tr></table></figure></p>
<p>由于CIFAR10数据集较为困难，我们考虑利用CV方法进行特征提取，这里我们使用HOG特征提高分类效果，首先将彩色图像转换为灰度图像</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">RGB2Gray</span>(<span class="params">image</span>):</span><br><span class="line">    image = <span class="number">0.299</span> * image[<span class="number">0</span>] + <span class="number">0.587</span> * image[<span class="number">1</span>] + <span class="number">0.114</span> * image[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">return</span> image.reshape(<span class="number">1</span>, *image.shape)</span><br></pre></td></tr></table></figure>
<p>然后实现一个简单的HOG特征提取函数，这里我们没有实现区块重叠，对该函数进行改进应该可以进一步提高分类效果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">HOG</span>(<span class="params">image, block=<span class="number">4</span>, partition=<span class="number">8</span></span>):</span><br><span class="line">    image = RGB2Gray(image).squeeze(axis=<span class="number">0</span>)</span><br><span class="line">    height, width = image.shape</span><br><span class="line">    gradient = np.zeros((<span class="number">2</span>, height, width), dtype=np.float32)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, height-<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, width-<span class="number">1</span>):</span><br><span class="line">            delta_x = image[i, j-<span class="number">1</span>] - image[i, j+<span class="number">1</span>]</span><br><span class="line">            delta_y = image[i+<span class="number">1</span>, j] - image[i-<span class="number">1</span>, j]</span><br><span class="line">            gradient[<span class="number">0</span>, i, j] = np.sqrt(delta_x ** <span class="number">2</span> + delta_y ** <span class="number">2</span>)</span><br><span class="line">            gradient[<span class="number">1</span>, i, j] = np.degrees(np.arctan2(delta_y, delta_x))</span><br><span class="line">            <span class="keyword">if</span> gradient[<span class="number">1</span>, i, j] &lt; <span class="number">0</span>:</span><br><span class="line">                gradient[<span class="number">1</span>, i, j] += <span class="number">180</span></span><br><span class="line">    unit = <span class="number">360</span> / partition</span><br><span class="line">    vertical, horizontal = height // block, width // block</span><br><span class="line">    feature = np.zeros((vertical, horizontal, partition), dtype=np.float32)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(vertical):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(horizontal):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(block):</span><br><span class="line">                <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(block):</span><br><span class="line">                    rho = gradient[<span class="number">0</span>, i*block+k, j*block+l]</span><br><span class="line">                    theta = gradient[<span class="number">1</span>, i*block+k, j*block+l]</span><br><span class="line">                    index = <span class="built_in">int</span>(theta // unit)</span><br><span class="line">                    feature[i, j, index] += rho</span><br><span class="line">            feature[i, j] /= np.linalg.norm(feature[i, j]) + <span class="number">1e-6</span></span><br><span class="line">    <span class="keyword">return</span> feature.reshape(-<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>基于这些工具函数，我们可以优雅地完成图像分类任务，对于MNIST数据集，一个基于线性核的分类示例如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">X_train, y_train = MNIST(<span class="string">&#x27;./dataset/mnist_data/&#x27;</span>, group=<span class="string">&#x27;train&#x27;</span>)</span><br><span class="line">X_test, y_test = MNIST(<span class="string">&#x27;./dataset/mnist_data/&#x27;</span>, group=<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">X_train, X_test = X_train.reshape(-<span class="number">1</span>, <span class="number">28</span>*<span class="number">28</span>), X_test.reshape(-<span class="number">1</span>, <span class="number">28</span>*<span class="number">28</span>)</span><br><span class="line"></span><br><span class="line">model = SupportVectorClassifier(iteration=<span class="number">100</span>, penalty=<span class="number">0.05</span>)</span><br><span class="line">model.fit(X_train, y_train)</span><br><span class="line">p_train, p_test = model.predict(X_train), model.predict(X_test)</span><br><span class="line"></span><br><span class="line">r_train, r_test = ComputeAccuracy(p_train, y_train), ComputeAccuracy(p_test, y_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Kernel: Linear, Train: &#123;:.2%&#125;, Test: &#123;:.2%&#125;&#x27;</span>.<span class="built_in">format</span>(r_train, r_test))</span><br></pre></td></tr></table></figure>
<p>对于CIFAR10数据集，一个基于HOG特征和高斯核的分类示例如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">X_train, y_train = CIFAR10(<span class="string">&#x27;./dataset/cifar-10-batches-py/&#x27;</span>, group=<span class="string">&#x27;train&#x27;</span>)</span><br><span class="line">X_test, y_test = CIFAR10(<span class="string">&#x27;./dataset/cifar-10-batches-py/&#x27;</span>, group=<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">X_train, X_test = BatchHOG(X_train, partition=<span class="number">16</span>), BatchHOG(X_test, partition=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">kernel = &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;gaussian&#x27;</span>, <span class="string">&#x27;gamma&#x27;</span>: <span class="number">0.03</span>&#125;</span><br><span class="line">model = SupportVectorClassifier(iteration=<span class="number">100</span>, kernel=kernel)</span><br><span class="line">model.fit(X_train, y_train)</span><br><span class="line">p_train, p_test = model.predict(X_train), model.predict(X_test)</span><br><span class="line"></span><br><span class="line">r_train, r_test = ComputeAccuracy(p_train, y_train), ComputeAccuracy(p_test, y_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Kernel: Gaussian, Train: &#123;:.2%&#125;, Test: &#123;:.2%&#125;&#x27;</span>.<span class="built_in">format</span>(r_train, r_test))</span><br></pre></td></tr></table></figure>
<p>经过测试，我们实现的SVM分类器在MNIST和CIFAR10数据集上的分类精度如下表所示</p>
<table style="text-align:center">
    <thead>
        <tr>
            <th>核函数</th>
            <th>组别</th>
            <th>MNIST</th>
            <th>CIFAR10</th>
            <th>CIFAR10-HOG</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td rowspan="2">线性核</td>
            <td>训练集</td>
            <td>96.96%</td>
            <td>76.14%</td>
            <td>77.58%</td>
        </tr>
        <tr>
            <td>测试集</td>
            <td>90.70%</td>
            <td>33.60%</td>
            <td>39.50%</td>
        </tr>
        <tr>
            <td rowspan="2">多项式核</td>
            <td>训练集</td>
            <td>100.00%</td>
            <td>99.86%</td>
            <td>100.00%</td>
        </tr>
        <tr>
            <td>测试集</td>
            <td>94.00%</td>
            <td>37.70%</td>
            <td>44.10%</td>
        </tr>
        <tr>
            <td rowspan="2">高斯核</td>
            <td>训练集</td>
            <td><b>99.68%</b></td>
            <td>99.14%</td>
            <td><b>94.54%</b></td>
        </tr>
        <tr>
            <td>测试集</td>
            <td><b>94.80%</b></td>
            <td>34.10%</td>
            <td><b>47.00%</b></td>
        </tr>
        <tr>
            <td rowspan="2">Sigmoid核</td>
            <td>训练集</td>
            <td>95.42%</td>
            <td>7.96%</td>
            <td>59.82%</td>
        </tr>
        <tr>
            <td>测试集</td>
            <td>92.10%</td>
            <td>7.40%</td>
            <td>44.70%</td>
        </tr>
    </tbody>
</table>

<p>此外，我们对模型的收敛性和各个核函数的参数选择进行了测试，模型精度与迭代次数的关系如下图所示</p>
<p><img src="/images/support-vector-machine/convergence.png" style="zoom: 75%;" /></p>
<p>线性核分类精度与 $C$ 和 $\varepsilon$ 的关系如下图所示</p>
<p><img src="/images/support-vector-machine/linear.png" style="zoom: 75%;" /></p>
<p>多项式核分类精度与 $\gamma$ 和 $d$ 的关系如下图所示</p>
<p><img src="/images/support-vector-machine/polynomial.png" style="zoom: 75%;" /></p>
<p>高斯核分类精度与 $C$ 和 $\gamma$ 的关系如下图所示</p>
<p><img src="/images/support-vector-machine/gaussian.png" style="zoom: 75%;" /></p>
<p>Sigmoid核分类精度与 $\gamma$ 和 $r$ 的关系如下图所示</p>
<p><img src="/images/support-vector-machine/sigmoid.png" style="zoom: 75%;" /></p>
<p>上述结果揭示了各个参数对模型性能的影响，可以为调参提供一定的指导作用</p>
<h2 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h2><p>SVM从过去的炙手可热到如今的日薄西山，仅仅过去了十年的时间，无论是精度还是效率，SVM都完败于当下随处可见的神经网络，关于从零开始实现SVM的意义，我也感到迷茫，但这一过程或多或少改变了我对机器学习的认知，一个简洁优雅的多项式时间精确算法，也许只能满足理论研究者的洁癖，而优化复杂模型的近似算法，在工程上赢得了未来。作为一门课程的大作业，笔者的实现难免存在疏漏和不足，希望读者谅解</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://xxyqwq.github.io/2023/03/18/acmoj-1125/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="xxyQwQ">
      <meta itemprop="description" content="xxyQwQ的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="xxyQwQ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/18/acmoj-1125/" class="post-title-link" itemprop="url">【题解】ACMOJ 1125 合并优先队列</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2023-03-18 22:54:31 / 修改时间：23:10:13" itemprop="dateCreated datePublished" datetime="2023-03-18T22:54:31+08:00">2023-03-18</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%A2%98%E8%A7%A3/" itemprop="url" rel="index"><span itemprop="name">题解</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p><a target="_blank" rel="noopener" href="https://acm.sjtu.edu.cn/OnlineJudge/problem/1125">ACMOJ - 1125 - 合并优先队列</a></p>
<p>初始共有 $n$ 个数各成一组，设计一个算法支持以下操作：</p>
<ul>
<li>将第 $x$ 组和第 $y$ 组合并</li>
<li>删除并输出第 $x$ 组中最小的数</li>
<li>向第 $x$ 组中加入一个数 $y$</li>
</ul>
<p>保证初始个数 $n\leq 3\times 10^5$，操作次数 $m\leq 3\times 10^5$</p>
<h3 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h3><p>我们构造 $n$ 个优先队列，直接模拟即可，对于合并操作，只要将第 $y$ 组中的元素依次弹出，插入到第 $x$ 组中即可。这种解法的复杂度高达 $O(nm\log n)$，但是由于测试数据的随机性，不会发生最坏情况</p>
<p>事实上，我们只需稍作修改，利用<strong>启发式合并</strong>的方法，每次合并将较小的队列合并到较大的队列中，这样可以保证每次合并的均摊复杂度为 $O(\log n)$，总复杂度为 $O\left ((n+m)\log ^2 n\right )$</p>
<h3 id="一些细节"><a href="#一些细节" class="headerlink" title="一些细节"></a>一些细节</h3><p>务必保证优先队列实现的正确性，且预分配空间不要过大，否则可能会内存超限</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p>这里只给出朴素算法直接模拟的代码，启发式合并读者可以自行实现</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cctype&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdarg&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> NMAX = <span class="number">300005</span>;</span><br><span class="line"></span><br><span class="line">std::priority_queue&lt;<span class="type">int</span>, std::vector&lt;<span class="type">int</span>&gt;, std::greater&lt;<span class="type">int</span>&gt;&gt; q[NMAX];</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;value)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    T result = <span class="built_in">T</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> word = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(word))</span><br><span class="line">        sign |= (word == <span class="string">&#x27;-&#x27;</span>), word = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(word))</span><br><span class="line">        result = result * <span class="number">10</span> + <span class="built_in">T</span>(word - <span class="string">&#x27;0&#x27;</span>), word = <span class="built_in">getchar</span>();</span><br><span class="line">    value = sign ? -result : result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Ts&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;value, Ts &amp;...remain)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(value);</span><br><span class="line">    <span class="built_in">read</span>(remain...);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n, m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, x; i &lt; n; i++)</span><br><span class="line">        <span class="built_in">read</span>(x), q[i].<span class="built_in">push</span>(x);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, x, a, b; i &lt; m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(x);</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">read</span>(a, b);</span><br><span class="line">            <span class="keyword">while</span> (!q[b].<span class="built_in">empty</span>())</span><br><span class="line">                q[a].<span class="built_in">push</span>(q[b].<span class="built_in">top</span>()), q[b].<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (x == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">read</span>(a);</span><br><span class="line">            <span class="keyword">if</span> (q[a].<span class="built_in">empty</span>())</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;-1\n&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, q[a].<span class="built_in">top</span>()), q[a].<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (x == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">read</span>(a, b);</span><br><span class="line">            q[a].<span class="built_in">push</span>(b);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://xxyqwq.github.io/2023/03/18/acmoj-1049/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="xxyQwQ">
      <meta itemprop="description" content="xxyQwQ的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="xxyQwQ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/18/acmoj-1049/" class="post-title-link" itemprop="url">【题解】ACMOJ 1049 前序中序求二叉树</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2023-03-18 22:38:17 / 修改时间：22:52:13" itemprop="dateCreated datePublished" datetime="2023-03-18T22:38:17+08:00">2023-03-18</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%A2%98%E8%A7%A3/" itemprop="url" rel="index"><span itemprop="name">题解</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p><a target="_blank" rel="noopener" href="https://acm.sjtu.edu.cn/OnlineJudge/problem/1049">ACMOJ - 1049 - 前序中序求二叉树</a></p>
<p>给定二叉树的前序遍历和中序遍历，将二叉树以数组形式输出</p>
<p>保证节点个数 $n\leq 26$，且输出长度 $k\leq 10^3$</p>
<h3 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h3><p>这是一个经典的二叉树问题，我们使用递归的方法求解：</p>
<ul>
<li>选取前序遍历的第一个节点作为子树根节点</li>
<li>在中序遍历中找到该节点的位置，其左侧构成左子树，右侧构成右子树</li>
<li>将前序遍历相应地分成两棵子树，分别递归地重复上述过程</li>
</ul>
<p>由于递归深度不超过 $n$，每层子问题的规模之和也不超过 $n$，因此时间复杂度为 $O(n^2)$</p>
<h3 id="一些细节"><a href="#一些细节" class="headerlink" title="一些细节"></a>一些细节</h3><ol>
<li>注意数组开够大小，避免越界</li>
<li>注意递归的边界条件和参数传递准确无误</li>
</ol>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> pre[<span class="number">35</span>], mid[<span class="number">35</span>], val[<span class="number">1005</span>];</span><br><span class="line"><span class="type">int</span> len, cnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">find</span><span class="params">(<span class="type">int</span> pre_left, <span class="type">int</span> pre_right, <span class="type">int</span> mid_left, <span class="type">int</span> mid_right, <span class="type">int</span> order)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (mid_left &gt; mid_right)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    val[order] = pre[pre_left], cnt = std::<span class="built_in">max</span>(cnt, order);</span><br><span class="line">    <span class="type">int</span> root = mid_left;</span><br><span class="line">    <span class="keyword">while</span> (root &lt;= mid_right &amp;&amp; mid[root] != pre[pre_left])</span><br><span class="line">        root++;</span><br><span class="line">    <span class="built_in">find</span>(pre_left + <span class="number">1</span>, pre_left + root - mid_left, mid_left, root - <span class="number">1</span>, order &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">find</span>(pre_left + root - mid_left + <span class="number">1</span>, pre_right, root + <span class="number">1</span>, mid_right, order &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s%s&quot;</span>, pre, mid), len = <span class="built_in">strlen</span>(pre);</span><br><span class="line">    <span class="built_in">find</span>(<span class="number">0</span>, len - <span class="number">1</span>, <span class="number">0</span>, len - <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++)</span><br><span class="line">        <span class="keyword">if</span> (val[i])</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c &quot;</span>, val[i]);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;NULL &quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://xxyqwq.github.io/2023/03/18/acmoj-1216/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="xxyQwQ">
      <meta itemprop="description" content="xxyQwQ的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="xxyQwQ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/18/acmoj-1216/" class="post-title-link" itemprop="url">【题解】ACMOJ 1216 括号匹配</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2023-03-18 19:39:21 / 修改时间：20:01:02" itemprop="dateCreated datePublished" datetime="2023-03-18T19:39:21+08:00">2023-03-18</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%A2%98%E8%A7%A3/" itemprop="url" rel="index"><span itemprop="name">题解</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p><a target="_blank" rel="noopener" href="https://acm.sjtu.edu.cn/OnlineJudge/problem/1216">ACMOJ - 1216 - 括号匹配</a></p>
<p>模拟一个括号栈，包含<code>()[]&#123;&#125;</code>六种括号，支持如下四种操作：</p>
<ol>
<li>向栈中压入元素</li>
<li>从栈中弹出元素</li>
<li>查询栈顶元素</li>
<li>判断栈中自底向上构成的括号序列是否匹配</li>
</ol>
<p>保证操作次数 $n\leq 10^6$</p>
<h3 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h3><p>前置知识：利用栈进行括号匹配 <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/134675879">参考链接</a></p>
<p>由于本题需要支持动态匹配，我们维护<strong>两个</strong>栈，$P$ 用于保存括号，$Q$ 用于括号匹配</p>
<ul>
<li>向 $P$ 中压入元素 $x$ 时，我们按照括号匹配的规则对 $Q$ 进行维护</li>
<li>从 $P$ 中弹出元素 $x$ 时，我们将压入 $x$ 时对 $Q$ 的修改还原</li>
</ul>
<p>由于压入 $x$ 时，可能会向 $Q$ 中压入元素，也可能会从 $Q$ 中弹出元素，因此我们需要记录 $x$ 对 $Q$ 的修改类型，方便后续的维护</p>
<p>由于每次操作的复杂度都是 $O(1)$，算法的复杂度为 $O(n)$，由于问题规模 $n\leq 10^6$，如果使用 $O(n^2)$ 的算法处理问题一定会超时</p>
<h3 id="一些细节"><a href="#一些细节" class="headerlink" title="一些细节"></a>一些细节</h3><ol>
<li>推荐用数组模拟栈，代码会更加简洁</li>
<li>读入括号时，建议直接读入字符串，取其中首个元素，这样可以避免读入空字符的问题</li>
</ol>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> NMAX = <span class="number">1000005</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> s[NMAX], t[NMAX], b[<span class="number">5</span>], c;</span><br><span class="line"><span class="type">int</span> n, x, p = <span class="number">0</span>, q = <span class="number">0</span>;</span><br><span class="line"><span class="type">bool</span> f[NMAX];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, b), c = b[<span class="number">0</span>];</span><br><span class="line">            s[++p] = c;</span><br><span class="line">            <span class="keyword">if</span> (c == <span class="string">&#x27;)&#x27;</span> &amp;&amp; q &amp;&amp; t[q] == <span class="string">&#x27;(&#x27;</span>)</span><br><span class="line">                q--, f[p] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (c == <span class="string">&#x27;]&#x27;</span> &amp;&amp; q &amp;&amp; t[q] == <span class="string">&#x27;[&#x27;</span>)</span><br><span class="line">                q--, f[p] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (c == <span class="string">&#x27;&#125;&#x27;</span> &amp;&amp; q &amp;&amp; t[q] == <span class="string">&#x27;&#123;&#x27;</span>)</span><br><span class="line">                q--, f[p] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                t[++q] = c, f[p] = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (x == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!p)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            c = s[p];</span><br><span class="line">            <span class="keyword">if</span> (f[p])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (c == <span class="string">&#x27;)&#x27;</span>)</span><br><span class="line">                    t[++q] = <span class="string">&#x27;(&#x27;</span>;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (c == <span class="string">&#x27;]&#x27;</span>)</span><br><span class="line">                    t[++q] = <span class="string">&#x27;[&#x27;</span>;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (c == <span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">                    t[++q] = <span class="string">&#x27;&#123;&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                q--;</span><br><span class="line">            p--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (x == <span class="number">3</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!p)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c\n&quot;</span>, s[p]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (x == <span class="number">4</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, q ? <span class="string">&quot;NO&quot;</span> : <span class="string">&quot;YES&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://xxyqwq.github.io/2023/02/02/sophomore-life/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="xxyQwQ">
      <meta itemprop="description" content="xxyQwQ的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="xxyQwQ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/02/02/sophomore-life/" class="post-title-link" itemprop="url">【文章】我的大二生活</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-02-02 00:00:07" itemprop="dateCreated datePublished" datetime="2023-02-02T00:00:07+08:00">2023-02-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-02-16 11:39:48" itemprop="dateModified" datetime="2024-02-16T11:39:48+08:00">2024-02-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%96%87%E7%AB%A0/" itemprop="url" rel="index"><span itemprop="name">文章</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="暑假生活"><a href="#暑假生活" class="headerlink" title="暑假生活"></a>暑假生活</h2><p>小学期结束以后，是一段清闲的时光，而我正想趁此机会做些自己想做的事情。班里有同学邀请我参加ICPC，我参加了preseason training，在数场比赛后我清醒地意识到相比群里其他队爷，我的水平非常有限，遂犹豫是否返校参加选拔。我权衡再三，还是不愿舍弃在家躺平的暑假时光，学期中停课备赛也是我难以接受的。适逢老师邀请我进组打工，我便借机脱身了。后来那位同学如愿拿到了ICPC Regional的金牌，令人艳羡。回过头看，倘若当时我义无反顾地参加ICPC，或许也能取得不错的成绩，然而鉴于这一学期的灾难式的学习压力，放弃不失为一个明智的选择。</p>
<p>暑假末期，我提前十几天返校做迎新志愿者，以弥补网课学期可怜的素拓分数（事实上效果并不显著）。闲暇的时间正好做一些预习工作，赶在开学前刚好看完了大学物理，概率统计和信号与系统。此时的我满怀信心，对未来的学习进度仿佛胸有成竹，丝毫没有意识到形势之严峻。</p>
<h2 id="线上与线下"><a href="#线上与线下" class="headerlink" title="线上与线下"></a>线上与线下</h2><p>经过上半年上海疫情的风波，大家都期待着回归正常的线下生活。然而现实总是离奇的，开学后上课的第一天就出现了感染者，线下教学未能撑满两节课就退回了线上。楼栋的封控一波接着一波，谁也不知道自己明天会不会吃上免费盒饭。长达六周的线上生活之后，终于回归了线下教学，但好景不长，一个月内疫情卷土重来，线上线下的同时进行使生活节奏愈发忙乱。又是两周之后，防疫口径发生重大转变，事实放开使疫情迅速在高校内蔓延，当我得知室友感染之后便火速逃离归家，尽管如此，生一场病已经难以避免。对于当下的人来说，这不过是一件必经的小事罢了。</p>
<h2 id="一些成就感"><a href="#一些成就感" class="headerlink" title="一些成就感"></a>一些成就感</h2><p>学期的前几周，我奔忙于各种评优事项，填了不少测评和申请表，最终也如愿拿到了一些奖学金。虽然数额不算很大，但累积起来已经可以cover一年的生活费。电院各个专业名列前茅者中不乏致远工科同学的身影，也正是看到国家奖学金名单的时候，我意识到很多大佬一直隐藏在我身边。在学科营辅导程序设计和数据结构在我看来也是很有意义的工作，我结识了很多新的朋友，看到了来自不同学院的大佬在各自擅长的领域展现杰出的才能。这些都是成就感的来源，鼓励着我更加积极地学习和生活。成就纪念过往的荣光，而我面向未知和远方。</p>
<h2 id="学习、学习、还是学习"><a href="#学习、学习、还是学习" class="headerlink" title="学习、学习、还是学习"></a>学习、学习、还是学习</h2><p>如果说大一的课程学习是负重前行，那么大二上的学习必然是在泥沼中阴暗地爬行。同样是30+学分，这一学期的课程难度和任务压力远远超出我的预期，让我时常感到狼狈不堪。各种作业和实验纷至沓来，我不得不花费大量精力才能保质保量地完成它们。有些课程的作业时常需要倾注一整天或者数天的努力，然而在完成之前，另一项作业又发布了，于是任务越积越多，负担也愈发沉重。此外，有些课程本身难度较高，给学习带来了巨大的挑战，例如繁琐复杂的模电被压缩在2学时的课程中，课后却必须花费超过4学时的时间去重新理解。</p>
<p>在这个学期，不同课程的学习体验产生了显著的差异。以张宇昊和陶表帅两位老师的算法设计与分析为例，这门课程对于证明严谨性和英文水平的要求较高，在编程任务中也有严格的代码查重，但是由于课程重要性强，老师讲解水平较高，助教也都非常负责，大家普遍掌握程度较高，好评如潮。反观信号与系统等课程，上课讲解效率低下，对于课后作业缺乏良好的指导，导致大家难以掌握扎实，怨声载道。</p>
<p>纵观整个学期的学习过程，仿佛置身漫长的黑暗隧道，在望不到尽头的恐惧中匍匐前行，又被沉重的枷锁缚住手脚，长期不得挣脱。这种痛苦源于不合理的培养计划和课程设计，作为学生如蝼蚁般无力改变。我凭借着扎实的基础和坚定的毅力最终坚持下来，可那些普通而无助的人又该如何呢？</p>
<h2 id="考试周"><a href="#考试周" class="headerlink" title="考试周"></a>考试周</h2><p>由于平时巨大的课程难度和任务量，即使临近考试周，大家手头仍有大量作业尚未完成，期末复习更是天方夜谭。得益于尽早完成任务的策略和前几周不懈的努力，我腾出了宝贵的一周提前进行复习。期间，我发现了大量的知识漏洞，并通过反复看书刷题来弥补，这一周的复习对部分课程的成绩至关重要。</p>
<p>总结来说，这一学期的考试有放水现象，平均分相较往年偏高。我对自己的成绩比较满意，其中大学物理和模拟电子技术的高分算是预料之外，计算机体系结构勉强90分不太满意，一方面是课程设计存在问题，不在本文讨论范围之内，另一方面在复习时忽视了对基本计算题型的训练。考虑到身体健康和时间安排，我申请了信号与系统的缓考，需要在寒假里做相应的复习和练习。</p>
<h2 id="年终总结"><a href="#年终总结" class="headerlink" title="年终总结"></a>年终总结</h2><p>我在自己2022年度总结的文案里写道：</p>
<blockquote>
<p>过去的一年里，几乎所有的计划都被打乱了，当初信誓旦旦要做的事情，满怀期许想学的知识，都在生活的一团乱麻中抛之脑后。我曾不止一次地想在闲暇之余探索一些专业知识，亦或是出去逛逛，让自己的生活显得不那么无聊，然而现实是极度的忙碌和频繁的封控，以至于热情终于被消磨殆尽。不可否认，这一年对我的影响是极大的，它迫使我不断地观察和思考，潜移默化地重塑着我对世界的理解。闻媛老师的《经济与社会伦理》让我印象深刻，它让我深入地思考社会运作的合理性，重新审视那些看似理所应当的认知，建立稳定的伦理思维。</p>
</blockquote>
<p>几个月来，我自囚于课程的一亩三分地难以脱身，为完成作业疲于奔命的狼狈真有几分抱薪救火的意味。我总是追求完满，却又太在意得失，囿于寻求局部的最优解，反而缺少了一以贯之的追求。我竭尽全力，究竟想要什么，这是一个亟待回答的问题。</p>
<h2 id="新的开始"><a href="#新的开始" class="headerlink" title="新的开始"></a>新的开始</h2><p>历史的进程呼啸而过，太多老人没有挺过那个寒冬，我坐在书桌前，早已听惯了白事的唢呐声，以至于有几分麻木。当春寒料峭时，我重新踏进校门，已是另一番图景，宽阔的道路上再没有人掩面而行，疾病像是从这片土地上消失了一般，只剩下宁静和安详。我隐隐感觉到一切都要归于寻常了，但21年入学的我其实并不知道何谓寻常，反而多了一些不安。开学的第一节课是俞凯老师的《智能语音识别》，上课铃响时教室里几乎是座无虚席，给人一种久违的紧迫感，把网课时期的慵懒和懈怠一扫而空。这是新学期的伊始，也是大学阶段一个全新的开始。</p>
<h2 id="清闲的时光"><a href="#清闲的时光" class="headerlink" title="清闲的时光"></a>清闲的时光</h2><p>学期的前几周，是在清闲中度过的，没有太多数学和物理课程的作业压力，也没有太高的课程难度，每天都有大把的时间可以自由支配。在这段时间里，我时常在傍晚出门散步，或是在周末和室友去校外改善伙食，潮汕汤面的海鲜汤面，御陕坊的油泼扯面，还有海宁煲和东记水饺，都称得上物美价廉。我开始读手边的CSAPP，并惊叹于它的包罗万象，从《程序设计》《计算机体系结构》到《操作系统》《计算机网络》都有深入浅出的讲解，无愧于作为一本顶级的自学指南。与此同时，我的CET6意外地拿到了600多分，这必须归功于试点班的培养模式，倘若没有江波老师全英文授课的《线性优化与凸优化》，我的听力大概会维持在高中毕业时的水准。舒适的生活节奏令人沉湎，但我清楚地知道这是短暂的，一旦各种作业布置下来，就会回归写代码赶报告的状态。</p>
<h2 id="谈谈大作业"><a href="#谈谈大作业" class="headerlink" title="谈谈大作业"></a>谈谈大作业</h2><p>临近期末的压力，80%来源于各门课程的大作业，剩下20%是小作业。</p>
<p>各种大作业的质量参差不齐，有些难度适中，与课程内容结合紧密，能够很好地提高学生的课程理解，有些过于简单，陈陈相因，是卷报告页数的高发地，有些难度过大，不知所云，与课程内容严重脱节，和造火箭并无二致。《深度学习》的作业设计便是一个表率，从回归到分类，从CNN到RNN，最终实现一个拼图任务，由浅入深，真正体现了张量变换的艺术。相比之下，《机器学习》和《智能语音识别》的大作业可谓折磨，前者是因为任务设计缺乏深思熟虑，低估了完整复现传统算法的难度，后者则是缺乏详尽的指导文档，对基础薄弱者极度不友好。对习惯于赶deadline的同学而言，学期的最后几周无疑是噩梦，甚至还要在考试周抽出时间在超算上排队完成LVCSR实验。然而，大作业扎堆的问题并没有给我造成困扰，我坚持任务提前的策略，提前一周完成了所有任务，于是我能够产出质量更高的内容，甚至有极其充裕的时间复习备考。</p>
<p>回顾这一学期的各门课程，我不得不承认多数课程的质量相当高，诸如《数字信号与图像处理》《随机过程》都能让人感觉到作业设计的用心之处，但并非所有老师都愿意在教学上投入大量精力，在现行的评价体系下这也无可厚非。</p>
<h2 id="又逢期末"><a href="#又逢期末" class="headerlink" title="又逢期末"></a>又逢期末</h2><p>“随机过程随机过，量子力学量力学”，尽管已是身经百战，期末考试的压迫感依旧十足。好在时间充裕，我便把王先智老师的PPT完整地看了一遍，再做试卷时倒也不是那么困难了，大概是老师们情知在工科开设《量子力学》有些为难学生，有意宽松给分，互相给一个台阶下罢了。《数字信号与图像处理》和《随机过程》的难度相比往年显著提升，这当然在预料之内，但由于老师善于捞人，给分并没有变差，唯有《机器学习》由于繁重的任务和苛刻的给分饱受抨击。</p>
<p>更有意思的是3学分的毛概被推上风口浪尖，由于不同教学班的均分存在显著差异，竟有同学致信教务处严查给分高的老师。诚然，利己主义者随处可见，但这种魔怔于学积分的心态着实令人感到可悲，有些人或许时至今日还没能明白“选择大于努力”这个浅显的道理。写到这里我不免要赞美北老师，他让我第一次发现红课也可以如此生动充实，而非令人昏昏欲睡的，我们的高等教育正是需要这类老师，把学生的素质培养和人格健全作为己任。</p>
<p>总而言之，这个期末还算令人满意，毕竟大多数课程都拿到了满绩，这应当归功于老师和我的共同努力。</p>
<h2 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h2><p>日子就这样一天天地过去，只有在看见新生军训的时候，我才会想起自己要成为大三老狗了。这一年中，我接触了很多新知，认识了很多大佬，实验室的实习也逐渐走上正轨。更多的选择摆在了我的面前，迫使我反复权衡，以免走错任何一步。无数令人不安的消息萦绕在耳畔，遮住了前路的微光，这个世界会好吗？我并不知道答案，我只能在黑暗中提灯探行，企图找到那一条属于我自己的幽径。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://xxyqwq.github.io/2022/10/14/acmoj-1486/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="xxyQwQ">
      <meta itemprop="description" content="xxyQwQ的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="xxyQwQ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/14/acmoj-1486/" class="post-title-link" itemprop="url">【题解】ACMOJ 1486 布尔表达式求值</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-10-14 19:37:44 / 修改时间：20:01:08" itemprop="dateCreated datePublished" datetime="2022-10-14T19:37:44+08:00">2022-10-14</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%A2%98%E8%A7%A3/" itemprop="url" rel="index"><span itemprop="name">题解</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p><a target="_blank" rel="noopener" href="https://acm.sjtu.edu.cn/OnlineJudge/problem?problem_id=1486">ACMOJ - 1486 - 布尔表达式求值</a></p>
<p>给定合法的布尔表达式，规则如下：</p>
<ul>
<li>$\text{f}$：字面量 false</li>
<li>$\text{t}$: 字面量 true</li>
<li>$\text{!}(x)$：非运算 not</li>
<li>$\text{&amp;}(x_1,x_2,\dots )$：与运算 and</li>
<li>$\text{|}(x_1,x_2,\dots )$：或运算 or</li>
</ul>
<p>计算布尔表达式的结果，保证长度 $|S|\leq10^4$</p>
<h3 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h3><p>与后缀表达式的处理方式类似，我们采用栈来存储表达式内容，由于括号和逗号并不产生实际语义，我们只保存操作符和字面量</p>
<p>顺序遍历表达式，将操作符和字面量依次入栈，忽略左括号和逗号，每当遇到右括号时执行出栈并完成一组计算，具体细节如下：</p>
<ul>
<li>不断弹出栈顶，直到遇到操作符</li>
<li>记录弹出字面量的类型，即是否出现过 true 和 false</li>
<li>对于 not 运算，只需取反唯一的运算数</li>
<li>对于 and 运算，若出现过 false，结果为 false，否则为 true</li>
<li>对于 or 运算，若出现过 true 结果为 true，否则为 false</li>
</ul>
<p>最后，我们将本次计算所得的结果以字面量的形式放回栈顶</p>
<p>该算法可在 $O(n)$ 的时间复杂度内完成表达式的计算</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> SIZE = <span class="number">20005</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Stack</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">Stack</span>() &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">bool</span> <span class="title">empty</span><span class="params">()</span> <span class="type">const</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">const</span> ElementType &amp;element)</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> ElementType <span class="title">pop</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> ElementType <span class="title">top</span><span class="params">()</span> <span class="type">const</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">clear</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LinkedStack</span> : <span class="keyword">public</span> Stack&lt;ElementType&gt;</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">StackNode</span></span><br><span class="line">    &#123;</span><br><span class="line">        ElementType data;</span><br><span class="line">        StackNode *next;</span><br><span class="line">        <span class="built_in">StackNode</span>() : <span class="built_in">next</span>(<span class="literal">nullptr</span>) &#123;&#125;</span><br><span class="line">        <span class="built_in">StackNode</span>(<span class="type">const</span> ElementType &amp;_data, StackNode *_next = <span class="literal">nullptr</span>) : <span class="built_in">data</span>(_data), <span class="built_in">next</span>(_next) &#123;&#125;</span><br><span class="line">        ~<span class="built_in">StackNode</span>() &#123;&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    StackNode *head;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">LinkedStack</span>();</span><br><span class="line">    ~<span class="built_in">LinkedStack</span>();</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">empty</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">const</span> ElementType &amp;element)</span></span>;</span><br><span class="line">    <span class="function">ElementType <span class="title">pop</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">ElementType <span class="title">top</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line">LinkedStack&lt;ElementType&gt;::<span class="built_in">LinkedStack</span>()</span><br><span class="line">&#123;</span><br><span class="line">    head = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line">LinkedStack&lt;ElementType&gt;::~<span class="built_in">LinkedStack</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">clear</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line"><span class="type">bool</span> LinkedStack&lt;ElementType&gt;::<span class="built_in">empty</span>() <span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> head == <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line"><span class="type">void</span> LinkedStack&lt;ElementType&gt;::<span class="built_in">push</span>(<span class="type">const</span> ElementType &amp;element)</span><br><span class="line">&#123;</span><br><span class="line">    head = <span class="keyword">new</span> <span class="built_in">StackNode</span>(element, head);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line">ElementType LinkedStack&lt;ElementType&gt;::<span class="built_in">pop</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="literal">nullptr</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="string">&quot;Stack is already empty!&quot;</span>;</span><br><span class="line">    StackNode *temp = head;</span><br><span class="line">    ElementType value = temp-&gt;data;</span><br><span class="line">    head = head-&gt;next;</span><br><span class="line">    <span class="keyword">delete</span> temp;</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line">ElementType LinkedStack&lt;ElementType&gt;::<span class="built_in">top</span>() <span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="literal">nullptr</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="string">&quot;Stack is already empty!&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> head-&gt;data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line"><span class="type">void</span> LinkedStack&lt;ElementType&gt;::<span class="built_in">clear</span>()</span><br><span class="line">&#123;</span><br><span class="line">    StackNode *temp;</span><br><span class="line">    <span class="keyword">while</span> (head != <span class="literal">nullptr</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        temp = head;</span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">        <span class="keyword">delete</span> temp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LinkedStack&lt;<span class="type">char</span>&gt; waiting;</span><br><span class="line"><span class="type">char</span> expression[SIZE];</span><br><span class="line"><span class="type">int</span> length, count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, expression);</span><br><span class="line">    length = <span class="built_in">strlen</span>(expression);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> position = <span class="number">0</span>; position &lt; length; position++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (expression[position] == <span class="string">&#x27;(&#x27;</span> || expression[position] == <span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (expression[position] == <span class="string">&#x27;)&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">bool</span> right = <span class="number">0</span>, wrong = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (!waiting.<span class="built_in">empty</span>() &amp;&amp; (waiting.<span class="built_in">top</span>() == <span class="string">&#x27;t&#x27;</span> || waiting.<span class="built_in">top</span>() == <span class="string">&#x27;f&#x27;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (waiting.<span class="built_in">pop</span>() == <span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">                    right = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    wrong = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">char</span> operation = waiting.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span> (operation == <span class="string">&#x27;!&#x27;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (right)</span><br><span class="line">                    waiting.<span class="built_in">push</span>(<span class="string">&#x27;f&#x27;</span>);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    waiting.<span class="built_in">push</span>(<span class="string">&#x27;t&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (operation == <span class="string">&#x27;&amp;&#x27;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (wrong)</span><br><span class="line">                    waiting.<span class="built_in">push</span>(<span class="string">&#x27;f&#x27;</span>);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    waiting.<span class="built_in">push</span>(<span class="string">&#x27;t&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (operation == <span class="string">&#x27;|&#x27;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (right)</span><br><span class="line">                    waiting.<span class="built_in">push</span>(<span class="string">&#x27;t&#x27;</span>);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    waiting.<span class="built_in">push</span>(<span class="string">&#x27;f&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            waiting.<span class="built_in">push</span>(expression[position]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, waiting.<span class="built_in">top</span>() == <span class="string">&#x27;t&#x27;</span> ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://xxyqwq.github.io/2022/10/14/acmoj-14373/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="xxyQwQ">
      <meta itemprop="description" content="xxyQwQ的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="xxyQwQ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/14/acmoj-14373/" class="post-title-link" itemprop="url">【题解】ACMOJ 14373 循环队列</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-10-14 17:33:17" itemprop="dateCreated datePublished" datetime="2022-10-14T17:33:17+08:00">2022-10-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-18 20:02:24" itemprop="dateModified" datetime="2023-03-18T20:02:24+08:00">2023-03-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%A2%98%E8%A7%A3/" itemprop="url" rel="index"><span itemprop="name">题解</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p><a target="_blank" rel="noopener" href="https://acm.sjtu.edu.cn/OnlineJudge/problem?problem_id=14373">ACMOJ - 14373 - 循环队列</a></p>
<p>实现一个循环队列，支持如下操作：</p>
<ol>
<li>将新的元素入队，并输出当前队尾的下标和元素个数</li>
<li>将队首元素出队，并输出当前队首的下标和元素个数</li>
</ol>
<h3 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h3><p>按照题目要求实现即可，本题输出较为严格，请注意实现的<strong>规范性</strong></p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Queue</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">Queue</span>() &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">bool</span> <span class="title">empty</span><span class="params">()</span> <span class="type">const</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">const</span> ElementType &amp;element)</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> ElementType <span class="title">pop</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> ElementType <span class="title">front</span><span class="params">()</span> <span class="type">const</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">clear</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SequentialQueue</span> : <span class="keyword">public</span> Queue&lt;ElementType&gt;</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    ElementType *elementData;</span><br><span class="line">    <span class="type">int</span> headPosition, tailPosition, totalCapacity;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">expand</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">SequentialQueue</span>(<span class="type">int</span> size = <span class="number">10</span>);</span><br><span class="line">    ~<span class="built_in">SequentialQueue</span>();</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">empty</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">const</span> ElementType &amp;element)</span></span>;</span><br><span class="line">    <span class="function">ElementType <span class="title">pop</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">ElementType <span class="title">front</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">get_head_position</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">get_tail_position</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">get_queue_length</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line"><span class="type">void</span> SequentialQueue&lt;ElementType&gt;::<span class="built_in">expand</span>()</span><br><span class="line">&#123;</span><br><span class="line">    ElementType *temp = elementData;</span><br><span class="line">    elementData = <span class="keyword">new</span> ElementType[<span class="number">2</span> * totalCapacity];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; totalCapacity; i++)</span><br><span class="line">        elementData[i] = temp[(headPosition + i) % totalCapacity];</span><br><span class="line">    headPosition = <span class="number">0</span>;</span><br><span class="line">    tailPosition = totalCapacity - <span class="number">1</span>;</span><br><span class="line">    totalCapacity *= <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">delete</span>[] temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line">SequentialQueue&lt;ElementType&gt;::<span class="built_in">SequentialQueue</span>(<span class="type">int</span> size)</span><br><span class="line">&#123;</span><br><span class="line">    elementData = <span class="keyword">new</span> ElementType[size];</span><br><span class="line">    totalCapacity = size;</span><br><span class="line">    headPosition = tailPosition = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line">SequentialQueue&lt;ElementType&gt;::~<span class="built_in">SequentialQueue</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">delete</span>[] elementData;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line"><span class="type">bool</span> SequentialQueue&lt;ElementType&gt;::<span class="built_in">empty</span>() <span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> headPosition == tailPosition;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line"><span class="type">void</span> SequentialQueue&lt;ElementType&gt;::<span class="built_in">push</span>(<span class="type">const</span> ElementType &amp;element)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ((tailPosition + <span class="number">1</span>) % totalCapacity == headPosition)</span><br><span class="line">        <span class="built_in">expand</span>();</span><br><span class="line">    tailPosition = (tailPosition + <span class="number">1</span>) % totalCapacity;</span><br><span class="line">    elementData[tailPosition] = element;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line">ElementType SequentialQueue&lt;ElementType&gt;::<span class="built_in">pop</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (headPosition == tailPosition)</span><br><span class="line">        <span class="keyword">throw</span> <span class="string">&quot;Queue is already empty!&quot;</span>;</span><br><span class="line">    headPosition = (headPosition + <span class="number">1</span>) % totalCapacity;</span><br><span class="line">    <span class="keyword">return</span> elementData[headPosition];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line">ElementType SequentialQueue&lt;ElementType&gt;::<span class="built_in">front</span>() <span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (headPosition == tailPosition)</span><br><span class="line">        <span class="keyword">throw</span> <span class="string">&quot;Queue is already empty!&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> elementData[(headPosition + <span class="number">1</span>) % totalCapacity];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line"><span class="type">void</span> SequentialQueue&lt;ElementType&gt;::<span class="built_in">clear</span>()</span><br><span class="line">&#123;</span><br><span class="line">    headPosition = tailPosition = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line"><span class="type">int</span> SequentialQueue&lt;ElementType&gt;::<span class="built_in">get_head_position</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> headPosition;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line"><span class="type">int</span> SequentialQueue&lt;ElementType&gt;::<span class="built_in">get_tail_position</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> tailPosition;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ElementType&gt;</span><br><span class="line"><span class="type">int</span> SequentialQueue&lt;ElementType&gt;::<span class="built_in">get_queue_length</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> (tailPosition - headPosition + totalCapacity) % totalCapacity;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x = <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (c &lt; <span class="string">&#x27;0&#x27;</span> || c &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">        c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        x = x * <span class="number">10</span> + c - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        c = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> s, n, t, x;</span><br><span class="line">    <span class="built_in">read</span>(s), <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="function">SequentialQueue&lt;<span class="type">int</span>&gt; <span class="title">Q</span><span class="params">(s)</span></span>;</span><br><span class="line">    <span class="keyword">while</span> (n--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(t);</span><br><span class="line">        <span class="keyword">if</span> (t == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">read</span>(x);</span><br><span class="line">            Q.<span class="built_in">push</span>(x);</span><br><span class="line">            std::cout &lt;&lt; Q.<span class="built_in">get_tail_position</span>() &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; Q.<span class="built_in">get_queue_length</span>() &lt;&lt; std::endl;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (t == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!Q.<span class="built_in">empty</span>())</span><br><span class="line">                Q.<span class="built_in">pop</span>();</span><br><span class="line">            std::cout &lt;&lt; Q.<span class="built_in">get_head_position</span>() &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; Q.<span class="built_in">get_queue_length</span>() &lt;&lt; std::endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="xxyQwQ"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">xxyQwQ</p>
  <div class="site-description" itemprop="description">xxyQwQ的个人博客</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">20</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/xxyQwQ" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;xxyQwQ" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:xxyQwQ@qq.com" title="E-Mail → mailto:xxyQwQ@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://plus.google.com/xxythecoder" title="Google → https:&#x2F;&#x2F;plus.google.com&#x2F;xxythecoder" rel="noopener" target="_blank"><i class="fab fa-google fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/xxyQwQ" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;xxyQwQ" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/xxyQwQ_" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;xxyQwQ_" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i></a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      友情链接
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://teru.space/" title="https:&#x2F;&#x2F;teru.space&#x2F;" rel="noopener" target="_blank">Teruteru的学习笔记</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://xp0123.github.io/" title="https:&#x2F;&#x2F;xp0123.github.io&#x2F;" rel="noopener" target="_blank">fy's blog</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-blog"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">personal blog of xxyQwQ</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
